var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(f,a,e){if(null==f)throw new TypeError("The 'this' value for String.prototype."+e+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+e+" must not be a regular expression");return f+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,a,e){f!=Array.prototype&&f!=Object.prototype&&(f[a]=e.value)};$jscomp.getGlobal=function(f){return"undefined"!=typeof window&&window===f?f:"undefined"!=typeof global&&null!=global?global:f};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(f,a,e,c){if(a){e=$jscomp.global;f=f.split(".");for(c=0;c<f.length-1;c++){var d=f[c];d in e||(e[d]={});e=e[d]}f=f[f.length-1];c=e[f];a=a(c);a!=c&&null!=a&&$jscomp.defineProperty(e,f,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("String.prototype.endsWith",function(f){return f?f:function(a,e){var c=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===e&&(e=c.length);e=Math.max(0,Math.min(e|0,c.length));for(var d=a.length;0<d&&0<e;)if(c[--e]!=a[--d])return!1;return 0>=d}},"es6","es3");$jscomp.polyfill("Object.is",function(f){return f?f:function(a,e){return a===e?0!==a||1/a===1/e:a!==a&&e!==e}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(f){return f?f:function(a,e){var c=this;c instanceof String&&(c=String(c));var d=c.length;for(e=e||0;e<d;e++)if(c[e]==a||Object.is(c[e],a))return!0;return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(f){return f?f:function(a,e){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,e||0)}},"es6","es3");
$jscomp.polyfill("String.prototype.repeat",function(f){return f?f:function(a){var e=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var c="";a;)if(a&1&&(c+=e),a>>>=1)e+=e;return c}},"es6","es3");$jscomp.findInternal=function(f,a,e){f instanceof String&&(f=String(f));for(var c=f.length,d=0;d<c;d++){var b=f[d];if(a.call(e,b,d,f))return{i:d,v:b}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.findIndex",function(f){return f?f:function(a,e){return $jscomp.findInternal(this,a,e).i}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var f=0;return function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+f++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.iterator;f||(f=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[f]&&$jscomp.defineProperty(Array.prototype,f,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(f){var a=0;return $jscomp.iteratorPrototype(function(){return a<f.length?{done:!1,value:f[a++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(f){$jscomp.initSymbolIterator();f={next:f};f[$jscomp.global.Symbol.iterator]=function(){return this};return f};$jscomp.iteratorFromArray=function(f,a){$jscomp.initSymbolIterator();f instanceof String&&(f+="");var e=0,c={next:function(){if(e<f.length){var d=e++;return{value:a(d,f[d]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};
$jscomp.polyfill("Array.prototype.values",function(f){return f?f:function(){return $jscomp.iteratorFromArray(this,function(a,e){return e})}},"es6","es3");"function"!=typeof Object.create&&(Object.create=function(){var f=function(){};return function(a){if(1<arguments.length)throw Error("Second argument not supported");if("object"!=typeof a)throw TypeError("Argument must be an object");f.prototype=a;var e=new f;f.prototype=null;return e}}());
window.JSON||(window.JSON={parse:function(f){return eval("("+f+")")},stringify:function(f){if(f instanceof Object){var a="";if(f.constructor===Array){for(var e=0;e<f.length;a+=this.stringify(f[e])+",",e++);return"["+a.substr(0,a.length-1)+"]"}if(f.toString!==Object.prototype.toString)return'"'+f.toString().replace(/"/g,"\\$&")+'"';for(e in f)a+='"'+e.replace(/"/g,"\\$&")+'":'+this.stringify(f[e])+",";return"{"+a.substr(0,a.length-1)+"}"}return"string"===typeof f?'"'+f.replace(/"/g,"\\$&")+'"':String(f)}});
Array.prototype.indexOf||(Array.prototype.indexOf=function(f,a){var e=a?a:0;if(!this)throw new TypeError;a=this.length;if(0===a||e>=a)return-1;for(0>e&&(e=a-Math.abs(e));e<a;e++)if(this[e]===f)return e;return-1});
Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(f,a){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),c=e.length>>>0;if("function"!==typeof f)throw new TypeError("predicate must be a function");for(var d=0;d<c;){if(f.call(a,e[d],d,e))return d;d++}return-1},configurable:!0,writable:!0});window.console||(window.console={log:function(){},assert:function(){}});var RS2_T_UNKNOWN=0,RS2_T_MATRIX=1,RS2_T_GROUP=2,RS2_T_REPEAT=3,RS2_T_MATRIX_SELECT=4,RS2_T_LABEL=101,RS2_T_INTEGER=102,RS2_T_FLOAT=103,RS2_T_TEXT=104,RS2_T_TEXTAREA=105,RS2_T_DATETIME=106,RS2_T_RATING=107,RS2_T_SCALE=108,RS2_T_PHOTO=109,RS2_T_LOCATION=110,RS2_T_PROVCITY=111,RS2_T_SIGNATURE=112,RS2_T_RECORDING=113,RS2_T_UPLOAD=114,RS2_T_SELECT=201,RS2_T_MULSELECT=202,RS2_T_SORT=203,RS2_T_ASSIGNMENT=204,RS2_T_AUTOCOMPLETE=205,RS2_T_DROPDOWN=206,RS2_T_CASCADE=207,RS2_T_SELECT_H=208,RS2_T_MULSELECT_H=
209,RS2_T_MIXFILL=210,RS2_T_SCALE_MUL=211,RS2_T_MATRIX_FIXEDCOL=301,RS2_T_MATRIX_SELECT_FIXEDCOL=302,RS2_T_MATRIX_SELECT_COMPACT=303,RS2_QTYPES={group:RS2_T_GROUP,matrix:RS2_T_MATRIX,label:RS2_T_LABEL,integer:RS2_T_INTEGER,"float":RS2_T_FLOAT,text:RS2_T_TEXT,textarea:RS2_T_TEXTAREA,datetime:RS2_T_DATETIME,rating:RS2_T_RATING,scale:RS2_T_SCALE,photo:RS2_T_PHOTO,location:RS2_T_LOCATION,provcity:RS2_T_PROVCITY,select:RS2_T_SELECT,mulselect:RS2_T_MULSELECT,sort:RS2_T_SORT,assignment:RS2_T_ASSIGNMENT,
autocomplete:RS2_T_AUTOCOMPLETE,dropdown:RS2_T_DROPDOWN,matrix_select:RS2_T_MATRIX_SELECT,signature:RS2_T_SIGNATURE,recording:RS2_T_RECORDING,cascade:RS2_T_CASCADE,upload:RS2_T_UPLOAD,mixfill:RS2_T_MIXFILL,scalemul:RS2_T_SCALE_MUL};function RS2_QTYPE(f){return RS2_QTYPES[f]||RS2_T_UNKNOWN}
var RS2_S_NONE=0,RS2_S_EXIT=1,RS2_S_LOADED=2,RS2_S_EDITING=3,RS2_S_EDITED=4,RS2_S_VIEWING=5,RS2_P_NOACTION=0,RS2_P_EXIT=1,RS2_P_NEW=2,RS2_P_EDITED=3,RS2_P_INVALID=4,RS2_P_UPDATE=5,RS2_P_ALERT=6,RS2_P_SKIP=7,RS2_E_SUCCESS="rsuccess",RS2_E_ERROR="error",RS2_M_INIT=0,RS2_M_PAGE=1,RS2_M_UPDATE=2,RS2_M_ALERT=3,RS2_M_UI=4,RS2_M_EDITED=5,RS2_M_UI_INPUT=1,RS2_M_UI_SELECT=2,RS2_M_UI_UNSELECT=3,RS2_M_UI_COMMENT=101,RS2_PLATFORM_CATI=1,RS2_PLATFORM_CAPI=2,RS2_PLATFORM_CAWI=3,RS2_I_EDIT_INTERVIEW=1,RS2_I_EDIT_VIEW=
2,RS2_I_EDIT_CHECK=3,RS2_I_EDIT_PREVIEW=4,RS2_I_REMARK_NONE=1,RS2_I_REMARK_QUESTION=2,RS2_I_REMARK_PAGE=3;var RS2_UTIL=function(){var f={ASSERT_THROW:!0,assert:function(a,e){console.assert(a,e);if(!a&&_U.ASSERT_THROW)throw Error("ASSERTION FAILED:'"+(e||"")+"'");},log:function(a){console.log(a)},error:function(a,e){f.log("[SURVEY] Error : "+(a?a:"")+", exception : "+e)},info:function(a){f.log("[SURVEY] "+a)},debug:function(a){var e="";for(i=1;i<arguments.length;++i)e+="<<"+JSON.stringify(arguments[i])+">>";f.log("** [SURVEY] "+a+(0<e.length?", ["+e+"]":""))},dispatch_func:function(a,e,c){var d=c[0];e&&
(d=e+d);if(e=a[d])try{return e.apply(a,Array.prototype.slice.call(c,1))}catch(b){f.error(b,"in executing "+d)}},format_date:function(a){var e=a.getDate(),c=a.getMonth()+1;return""+a.getFullYear()+"-"+(9>=c?"0"+c:c)+"-"+(9>=e?"0"+e:e)},format_time:function(a){var e=a.getHours(),c=a.getMinutes();a=a.getSeconds();return""+(9>=e?"0"+e:e)+":"+(9>=c?"0"+c:c)+":"+(9>=a?"0"+a:a)},format_datetime:function(a){return this.format_date(a)+" "+this.format_time(a)},endsWith:function(a,e,c){if(void 0===c||c>a.length)c=
a.length;c-=e.length;a=a.indexOf(e,c);return-1!==a&&a===c},beginsWtih:function(a,e){return 0===a.indexOf(e)},empty_str:function(a){return a?0==a.length:!0},empty_texts:function(a){if(a&&0<a.length)for(var e=0;e<a.length;++e){var c=a[e];if(c&&0<c.length)return!1}return!0},random:function(a){return Math.floor(Math.random()*a)},shuffle:function(a){for(var e=a.length,c,d;0!==e;)d=Math.floor(Math.random()*e),--e,c=a[e],a[e]=a[d],a[d]=c},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},
read:function(a,e,c){var d=a[e];void 0===d&&(d=c,a[e]=c);return d},key:function(){for(var a,e=0;e<arguments.length;++e){var c=arguments[e];void 0!==c&&(a=a?a+"."+c:c)}return a},keyForValue:function(a,e){for(var c in a)if(a[c]==e)return c},copy_value:function(a){return this.isArray(a)?this.copy_array(a):"object"===typeof a?this.copy_obj(a):a},copy_obj:function(a){if(a){var e={},c;for(c in a)e[c]=a[c];return e}},copy_array:function(a){for(var e=[],c=0;c<a.length;++c)e[c]=a[c];return e},qualified:function(a,
e){var c=Object.create(a);c.prop=function(){var a=f.key.apply(f,arguments);return c[f.key(e,a)]};return c},call_async:function(a){setTimeout(function(){a()},50)},valueForPath:function(a,e){if(void 0!==a&&void 0!==e){e=e.split(".");for(var c=0;c<e.length&&void 0!==a;++c)a=a[e[c]];return a}},object_size:function(a){if(a){var e=0,c;for(c in a)e+=a.hasOwnProperty(c)?1:0;return e}},replace_illegal_char:function(a){return a?a.replace(/'|"/g,""):a},replace_nan:function(a,e){if(a){a=a.split("");for(var c=
!1,d=[],b=0;b<a.length;++b){var z=a[b];"0"<=z&&"9">=z?d.push(z):"-"===z&&0===b?d.push(z):!0===e&&0<b&&"."===z&&!c&&(c=!0,d.push(z))}return d.join("")}return a},replaceAll:function(a,e,c){return a.replace(new RegExp(e,"g"),c)}};return f}();var RS2_CORE_EXPR=function(){return{is_ref:function(f){return"string"==typeof p&&/#\{.+?\}/.test(f)},ref_name:function(f){var a=f.indexOf("#{"),e=f.indexOf("}",a);return 0<=a&&0<=e?f.slice(a+2,e):f},numeric_val:function(f){switch(typeof f){case "number":return f;case "string":return 1*f;default:return NaN}},option_key:function(f){var a=f.split("."),e={};0<a.length?(e.qid=a[0],2==a.length?e.opt=a[1]:(e.row=a[1],e.col=a[2],e.opt=a[3]),e.prop=a[a.length-1]):(e.qid=f,e.prop=f);return e}}}();var RS2_CORE_VLDT=function(f,a){function e(b,a){var c=[],d;if(void 0!==a)for(d=0;d<a.length;++d){var e=a[d];f.is_ref(e)&&(e=b.val(f.ref_name(e)));c[d]=e}return c}function c(b){return function(c,d){return function(z,E){var f=!0,w=!1;try{(w=!1!==b.skip_on_null&&!z.inputed("this")||b.skip_on_input&&!0!==E)||(f=b.creator.apply(b,e(z,c))(z))}catch(u){a.error("Failed to execute validator "+b.name+" on "+z.qid,u)}return{valid:f,name:b.name,message:d||b.message}}}}var d={};return{create:function(){var b=
{},e=Object.create(d);return{define:function(b){e[b.id]=c(b)},instance:function(b,a,c,d){if(b=e[b])return a=b(a,c),d&&(a.option=d),a},setup:function(a,c){if(c){var d=b[a];d||(d=[],b[a]=d);d.push(c)}},validate:function(c,d,e){c=b[c];var z=[];if(c)for(var f=0;f<c.length;++f){var u=c[f];var t=d;var n=u.option,g=t.qid,y=t.qvisible(g),l=t.qprop(g,"disabled");0==y||!0===l?t=!0:void 0!==n?(y=t.qprop(g,a.key(n,"visible")),l=t.qprop(g,a.key(n,"disabled")),t=!1===y||!0===l):t=!1;t||(r=u(d,e))&&!r.valid&&z.push(r.message)}return z}}},
define:function(b){d[b.id]=c(b)}}}(RS2_CORE_EXPR,RS2_UTIL);(function(f,a){function e(b,a){return function(c){c=c.val("this");return-9==c||!(isNaN(c)||c<b||c>a)}}function c(b){return function(a){return b.test(a.val("this",!1))}}function d(){var b=arguments;return function(a){a=a.val("this",!1);for(var c=0;c<b.length;++c)if(b[c].test(a))return!0;return!1}}f.define({id:"notnull",name:"\u5fc5\u586b\u9a8c\u8bc1",skip_on_null:!1,skip_on_input:!0,message:{zh:"\u672c\u9898\u5fc5\u586b\uff0c\u8bf7\u7b54\u5b8c\u518d\u8fdb\u5165\u4e0b\u4e00\u9875\uff01",en:"Please answer the question and then go to the next page!"},
creator:function(b){b&&(this.message={zh:"\u672c\u9898\u9009\u9879"+b+"\u5fc5\u586b\uff0c\u8bf7\u7b54\u5b8c\u518d\u8fdb\u5165\u4e0b\u4e00\u9875\uff01",en:"Please answer the "+b+" and then go to the next page!"});return function(c){var d=c.val("this",!1);d&&b&&(d=d[a.key(c.qid,b)]);return"string"===typeof d?0<d.length:void 0!==d&&null!==d}}});f.define({id:"selected",name:"\u5fc5\u586b\u9a8c\u8bc1",skip_on_null:!1,skip_on_input:!0,message:{zh:"\u672c\u9898\u5fc5\u586b\uff0c\u8bf7\u7b54\u5b8c\u518d\u8fdb\u5165\u4e0b\u4e00\u9875\uff01",
en:"Please answer the question and then go to the next page!"},creator:function(b,a){b&&a&&(this.message={zh:"\u672c\u9898 "+a+"."+b+" \u5fc5\u586b\uff0c\u8bf7\u7b54\u5b8c\u518d\u8fdb\u5165\u4e0b\u4e00\u9875\uff01",en:a+"."+b+" is required!"});return function(c){if(b&&a){var d=c.val("this",!1);if(d){var e=c.qid;c=c.qprop(e,b+".options");e=e+"."+a+"."+b;for(var z=0;z<c.length;++z)if("1"==d[e+"."+c[z]])return!0}}else if(d=c.val("this",!1))for(e in d)if("1"==d[e])return!0;return!1}}});f.define({id:"option_required",
name:"\u9009\u9879\u5fc5\u586b\u9a8c\u8bc1",skip_on_null:!1,skip_on_input:!0,message:"\u6709\u5fc5\u586b\u9009\u9879\u8bf4\u660e\u672a\u586b\uff0c\u8bf7\u7b54\u5b8c\u518d\u8fdb\u5165\u4e0b\u4e00\u9875\uff01",creator:function(a){return function(a){return!0}}});f.define({id:"option_input_required",name:"\u9009\u9879\u5fc5\u586b\u9a8c\u8bc1",skip_on_null:!1,skip_on_input:!0,message:"\u6709\u5fc5\u586b\u9009\u9879\u672a\u586b\uff0c\u8bf7\u7b54\u5b8c\u518d\u8fdb\u5165\u4e0b\u4e00\u9875\uff01",creator:function(b){return function(c){var d=
c.val("this",!1);return d&&(c=a.key(c.qid,b),"1"==d[c])?(d=d[c+".input"],void 0!==d&&null!==d&&0<d.length):!0}}});f.define({id:"scope",name:"\u6570\u503c\u8303\u56f4\u9a8c\u8bc1",message:"\u8f93\u5165\u6570\u636e\u8d85\u51fa\u8303\u56f4",creator:e});f.define({id:"year",name:"\u5e74\u4efd\u8303\u56f4\u9a8c\u8bc1",message:"\u5e74\u4efd\u503c\u5fc5\u987b\u57281900\u81f32050\u4e4b\u95f4",creator:function(){return e(1900,2050)}});f.define({id:"month",name:"\u6708\u4efd\u8303\u56f4\u9a8c\u8bc1",message:"\u6708\u4efd\u503c\u5fc5\u987b\u57281\u81f312\u4e4b\u95f4",
creator:function(){return e(1,12)}});f.define({id:"day",name:"\u65e5\u8303\u56f4\u9a8c\u8bc1",message:"\u65e5\u5fc5\u987b\u57281\u81f331\u4e4b\u95f4",creator:function(){return e(1,31)}});f.define({id:"hour",name:"\u5c0f\u65f6\u8303\u56f4\u9a8c\u8bc1",message:"\u5c0f\u65f6\u5fc5\u987b\u57280\u81f323\u4e4b\u95f4",creator:function(){return e(0,23)}});f.define({id:"minute",name:"\u5206\u949f\u8303\u56f4\u9a8c\u8bc1",message:"\u5206\u949f\u5fc5\u987b\u57280\u81f359\u4e4b\u95f4",creator:function(){return e(0,
59)}});f.define({id:"second",name:"\u79d2\u8303\u56f4\u9a8c\u8bc1",message:"\u79d2\u5fc5\u987b\u57280\u81f359\u4e4b\u95f4",creator:function(){return e(0,59)}});f.define({id:"equals",name:"\u7b49\u4e8e\u9a8c\u8bc1",message:"\u5fc5\u987b\u7b49\u4e8e",creator:function(a){this.message="\u5fc5\u987b\u7b49\u4e8e"+a;return function(b){b=b.val("this");return-9==b||b==a}}});f.define({id:"length",name:"\u5b57\u7b26\u4e32\u957f\u5ea6\u9a8c\u8bc1",message:"\u5b57\u7b26\u4e32\u957f\u5ea6\u8d85\u51fa\u8303\u56f4",
creator:function(a){this.message="\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7"+a+"\u4e2a\u5b57\u7b26";return function(b){return b.length(b.val("this",!1))<=a}}});f.define({id:"greatthan",name:"\u5927\u4e8e\u9a8c\u8bc1",message:"\u5fc5\u987b\u5927\u4e8e",creator:function(a){this.message="\u5fc5\u987b\u5927\u4e8e"+a;return function(b){b=b.val("this");return-9==b||b>a}}});f.define({id:"lessthan",name:"\u5c0f\u4e8e\u9a8c\u8bc1",message:"\u5fc5\u987b\u5c0f\u4e8e",creator:function(a){this.message="\u5fc5\u987b\u5c0f\u4e8e"+
a;return function(b){b=b.val("this");return-9==b||b<a}}});f.define({id:"nogreatthan",name:"\u5c0f\u4e8e\u7b49\u4e8e\u9a8c\u8bc1",message:"\u5fc5\u987b\u5c0f\u4e8e\u7b49\u4e8e",creator:function(a){this.message="\u5fc5\u987b\u5c0f\u4e8e\u7b49\u4e8e"+a;return function(b){b=b.val("this");return-9==b||b<=a}}});f.define({id:"nolessthan",name:"\u5927\u4e8e\u7b49\u4e8e\u9a8c\u8bc1",message:"\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e",creator:function(a){this.message="\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e"+a;return function(b){b=
b.val("this");return-9==b||b>=a}}});f.define({id:"expression",name:"\u6b63\u5219\u8868\u8fbe\u5f0f\u9a8c\u8bc1",message:"\u4e0d\u7b26\u5408\u89c4\u5b9a\u683c\u5f0f",creator:c});f.define({id:"email",name:"\u90ae\u4ef6\u683c\u5f0f\u9a8c\u8bc1",message:"\u4e0d\u7b26\u5408emal\u5730\u5740\u683c\u5f0f",creator:function(){return c(/^[\w-\.\d*]+@[\w\d]+(\.\w{2,4})$/)}});f.define({id:"post",name:"\u90ae\u653f\u7f16\u7801\u683c\u5f0f\u9a8c\u8bc1",message:"\u4e0d\u7b26\u5408\u90ae\u653f\u7f16\u7801\u683c\u5f0f",
creator:function(){return c(/^[1-9]{1}[\d]{5}$/)}});f.define({id:"phone",name:"\u56fa\u8bdd\u53f7\u7801\u683c\u5f0f\u9a8c\u8bc1",message:"\u4e0d\u7b26\u5408\u56fa\u8bdd\u53f7\u7801\u683c\u5f0f",creator:function(){return c(/^([0-9]{3,4}-)?[0-9]{7,8}$/)}});f.define({id:"mobile",name:"\u624b\u673a\u53f7\u7801\u683c\u5f0f\u9a8c\u8bc1",message:"\u4e0d\u7b26\u5408\u624b\u673a\u53f7\u7801\u683c\u5f0f",creator:function(){return c(/^[1]{1}[\d]{10}$/)}});f.define({id:"selected_max",name:"\u591a\u9009\u9a8c\u8bc1",
message:"\u6700\u591a\u9009\u62e9",creator:function(a){this.message="\u6700\u591a\u9009\u62e9"+a+"\u9879";return function(b){return b.selected("this")<=a}}});f.define({id:"selected_min",name:"\u591a\u9009\u9a8c\u8bc1",message:"\u6700\u5c11\u9009\u62e9",skip_on_input:!0,creator:function(a){this.message="\u6700\u5c11\u9009\u62e9"+a+"\u9879";return function(b){return b.selected("this")>=a}}});f.define({id:"sorted_all",name:"\u6392\u5e8f\u9a8c\u8bc1",message:"\u6700\u5c11\u6392\u5e8f",skip_on_input:!0,
skip_on_null:!1,creator:function(a){this.message="\u6240\u6709\u9009\u9879\u90fd\u987b\u8981\u6392\u5e8f";return function(b){var c=b.qid,d=b.qprop(c,"options"),e=0;if(void 0===a&&d)for(var z=0;z<d.length;++z){var f=d[z];!1!==b.qprop(c,f+".visible")&&!0!==b.qprop(c,f+".disabled")&&++e}return b.sorted("this")>=e}}});f.define({id:"sorted_min",name:"\u6392\u5e8f\u9a8c\u8bc1",message:"\u6700\u5c11\u6392\u5e8f",skip_on_input:!0,creator:function(a){this.message="\u6700\u5c11\u9009\u62e9"+a+"\u9879";return function(b){return b.sorted("this")>=
a}}});f.define({id:"sorted_max",name:"\u6392\u5e8f\u9a8c\u8bc1",message:"\u6700\u591a\u6392\u5e8f",skip_on_input:!0,creator:function(a){this.message="\u6700\u591a\u9009\u62e9"+a+"\u9879";return function(a){return a.sorted("this")<=max}}});f.define({id:"idcard",name:"\u8eab\u4efd\u8bc1\u683c\u5f0f\u9a8c\u8bc1",message:"\u4e0d\u7b26\u5408\u8eab\u4efd\u8bc1\u683c\u5f0f",creator:function(){return c(/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/)}});f.define({id:"dial",name:"\u8054\u7cfb\u65b9\u5f0f\u9a8c\u8bc1",
message:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u6216\u7535\u8bdd\u53f7\u7801",creator:function(){return d(/^([0]{1,1}[1-9]{3}[-]*)*([1-9]{1,1}[0-9]{6,7}){1,1}$/,/^[1]{1}[\d]{10}$/)}});f.define({id:"date",name:"\u65e5\u671f\u9a8c\u8bc1",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u65e5\u671f\u683c\u5f0f, \u4f8b\u5982 2017-12-15",creator:function(){return d(/^((?!0000)[0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|30|31)$/)}});f.define({id:"pointnum",name:"\u5c0f\u6570\u4f4d\u6570\u9a8c\u8bc1",message:"\u5c0f\u6570\u4f4d\u6570\u8d85\u8fc7\u6307\u5b9a\u957f\u5ea6",
creator:function(a,c){this.message="\u6700\u591a\u4fdd\u7559"+c+"\u4f4d\u5c0f\u6570";c="(\\.\\d{"+a+","+c+"})";0==a?c+="?":this.message+=", \u6700\u5c11"+a+"\u4f4d";var b=new RegExp("^(([1-9]{1}\\d*)|(0{1}))"+c+"$");return function(a){return b.test(a.val("this",!1))}}});f.define({id:"chinese",name:"\u4e2d\u6587\u9a8c\u8bc1",message:"\u53ea\u80fd\u8f93\u5165\u4e2d\u6587\u5b57\u7b26",creator:function(){return d(/^[\u4e00-\u9fa5]+$/)}});f.define({id:"english",name:"\u82f1\u6587\u9a8c\u8bc1",message:"\u53ea\u80fd\u8f93\u5165\u82f1\u6587\u5b57\u6bcd",
creator:function(){return d(/^[a-zA-Z]+$/)}})})(RS2_CORE_VLDT,RS2_UTIL);var RS2_CORE_DATA=function(f){var a={extend:function(a,c){var d=Object.create(this),b=Object.create(this.bindings);b["this"]=a;if(c)for(var e in c)b[e]=c[e];d.bindings=b;d.qid=a;return d},resolve:function(a){if(this.bindings){var c=this.bindings[a];return void 0===c?a:c}return a}};return{create:function(){function e(a,b,c){if(a){var g=a[b];if("string"===typeof g)return a=f.copy_obj(a),a[b]=d[g]||c,a}}function c(a,b,c){b&&(b=b[c],"string"===typeof b&&(a[b]=d[b]))}var d={},b={},z={},E={},A={},w={},
q=Object.create(a);q.bindings={};q.qprop=function(a,c){if(a=b[this.resolve(a)])return a[c]};q.val=function(a,b){var c=a.indexOf(".");if(0<c){var g=a.substr(0,c);var e=a.substr(c+1)}else g=a;g=this.resolve(g);a=E[g];void 0!==a?e&&(a=a[g+"."+e]):(a=d[g],void 0===a&&(a=A[g]),a&&e&&(a=f.valueForPath(a,e)));if(!1!==b&&a){a:switch(typeof a){case "number":b=a;break a;case "string":b=1*a;break a;default:b=NaN}isNaN(b)||(a=b)}return a};q.inputed=function(a){a=this.val(this.resolve(a),!1);return"object"===
typeof a?0<f.object_size(a):void 0!=a&&null!=a&&""!=a};q.extern=function(a){return A[a]};q.qvisible=function(a){return!1===x.qprop(a,void 0,"interviewer_visible")?!1:x.qprop(a,void 0,"visible")};var x={env:function(a,b){return q.extend(a,b)},vars:function(){return d},submit_vars:function(){var a={},b;for(b in d)!0!==w[b+".readonly"]&&(a[b]=d[b]);return a},qvals:function(){return E},qdata:function(){return b},setup_vars:function(a,b){if(a)for(var c in a)d[c]=a[c];if(b)for(c in b)w[c]=b[c]},setup_qvals:function(a){if(a)for(var b in a)E[b]=
a[b]},setup_qdata:function(a){if(a)for(var c in a)b[c]=a[c]},setup_qeditdata:function(a){z=a||{}},define_func:function(a,b){q[a]=b},qval:function(a){return E[a]},set_qval:function(a,b){E[a]=b},input:function(a,b,c){if(c){a=f.read(E,a,{});for(var d in b)a[d]=b[d]}else E[a]=b},qprops:function(a){return b[a]},qprop:function(a,c,d){void 0===d&&(d=c,c=void 0);if(a=b[a])return a[f.key(c,d)]},qprops_updated:function(){return z},set_qprops:function(a,c){b[a]=c;delete z[a]},set_qprop:function(a,c,d){(a=b[a])&&
(a[c]=d)},update_qprop:function(a,b,c){var d=z[a];void 0==d&&(d={},z[a]=d);d[b]=c},put_qvars:function(a,b){b=x.qprops(b);if(void 0!==b)switch(b.type){case RS2_T_AUTOCOMPLETE:case RS2_T_DROPDOWN:case RS2_T_SELECT:case RS2_T_MULSELECT:c(a,b,"options");break;case RS2_T_CASCADE:if(b=b.data)for(var d=0;d<b.length;++d)c(a,b[d],"options")}},build_props:function(a){a=x.qprops(a);if(void 0!==a)switch(a.type){case RS2_T_AUTOCOMPLETE:var b=e(a,"options",[]);void 0!==b&&(a=b);break;case RS2_T_CASCADE:var c=[];
b=!1;var d=a.data;if(d)for(var y=0;y<d.length;++y){var l=e(d[y],"options",[]);void 0!==l?(b||(a=f.copy_obj(a),a.data=c),c.push(l)):c.push(d[y])}}return a},qvisible:function(a){return!1===x.qprop(a,void 0,"interviewer_visible")?!1:x.qprop(a,void 0,"visible")},vval:function(a){return d[a]},set_vval:function(a,b){d[a]=b},sys_vval:function(a){return d["__sys_"+a]},set_sys_vval:function(a,b){d["__sys_"+a]=b},setup_externs:function(a){if(a)for(var b in a)A[b]=a[b]},extern:function(a){return A[a]},apply_updates:function(a,
c){for(var d=b[a],g=E[a],e=0;e<c.length;++e){var l=c[e],m=l.prop,z=l.value;try{if("value"===m)if(!g||!l.update)g=z,E[a]=g;else{if(!0===l.update)for(var t in z)g[t]=z[t]}else if("options"===m){var G=m=void 0,H=d,q=H.options;if(q){var w="title has_input input_type group res res_type right_label".split(" ");for(G=0;G<q.length;++G){var u=q[G];for(m=0;m<w.length;++m)delete H[f.key(u,w[m])]}H.options=[]}if(void 0!==z)for(t in z){var B=f.key(l.eid,t);d[B]=z[t];x.update_qprop(a,B,z[t])}}else B=f.key(l.eid,
m),d[B]=z,x.update_qprop(a,B,z)}catch(C){f.error("Failed to apply update ",C)}}},clear_question:function(a){this.set_qprops(a,void 0);this.set_qval(a,void 0)}};return x},define_func:function(e,c){a[e]=c}}}(RS2_UTIL);(function(f,a){f.define_func("equals",function(a,c){return a==c});f.define_func("length",function(a){return a.length});f.define_func("concat",function(a,c){return a+c});f.define_func("choose",function(){if(0==arguments.length)return"";var a=0;1<arguments.length&&(a=Math.floor(arguments.length*Math.random()));return arguments[a]});f.define_func("ifval",function(a,c,d){return a===c?d:a});f.define_func("option",function(e){e=this.resolve(e);v=this.val(e,!1);e+=".";if("object"===typeof v)for(k in v)if(a.beginsWtih(k,
e)&&"1"==v[k])return k.substr(e.length)});f.define_func("option_text",function(e){e=this.resolve(e);v=this.val(e,!1);var c=e+".";if("object"===typeof v)for(k in v)if(a.beginsWtih(k,c)&&"1"==v[k])return(e=this.qprop(e,k.substr(c.length)+".title"))&&0<e.length?e[0]:""});f.define_func("selected",function(a){a=this.val(a||"this",!1);var c=0;if("object"===typeof a)for(var d in a)c+="1"==a[d]?1:0;return c});f.define_func("selected_opt",function(e,c){e=this.val(e,!1);var d=0;if("object"===typeof e)for(var b in e)"1"==
e[b]&&(d+=a.endsWith(b,c));return d});f.define_func("ifnull",function(a,c){return void 0===a||null===a?c:"string"===typeof a?0<a.length?a:c:a});f.define_func("isnull",function(a){a=((a||"")+"").replace(/(^\s*)|(\s*$)/,"");return 0<a.length?!1:!0});f.define_func("auto_date",function(a,c,d){var b=new Date,e={},f=b.getDate(),A=b.getMonth()+1;e.Y=b.getFullYear();e.M=10>A?"0"+A:A;e.D=10>f?"0"+f:f;return e[a||"Y"]+"/"+e[c||"M"]+"/"+e[d||"D"]});f.define_func("auto_time",function(){var a=new Date,c=a.getHours(),
d=a.getMinutes();a=a.getSeconds();return""+(9>=c?"0"+c:c)+":"+(9>=d?"0"+d:d)+":"+(9>=a?"0"+a:a)});f.define_func("tofixed",function(a,c){try{return a.toFixed(c||2)}catch(d){return a}});f.define_func("sorted",function(a){a=this.val(a||"this",!1);var c=0;if("object"===typeof a)for(var d in a)c+=a.hasOwnProperty(d)?1:0;return c});f.define_func("create_options",function(a){for(var c=[],d=this.qprop(a,"options"),b=0;b<d.length;++b){var e=d[b];if("1"==this.val(a+"."+e)){var f={id:e};f.title=this.qprop(a,
e+".title");c.push(f)}}return c});f.define_func("create_options",function(a){for(var c=[],d=this.qprop(a,"options"),b=0;b<d.length;++b){var e=d[b];if("1"==this.val(a+"."+e)){var f={id:e};f.title=this.qprop(a,e+".title");c.push(f)}}return c});f.define_func("check_regex",function(a,c){return(new RegExp(c)).test(env.val(a,!1))});f.define_func("check_int",function(a){return/^[1-9]d*|0$/.test(this.val(a,!1))});f.define_func("check_float",function(a,c,d){d="(\\.\\d{"+c+","+d+"})";0==c&&(d+="?");return(new RegExp("^(([1-9]{1}\\d*)|(0{1}))"+
d+"$")).test(this.val(a,!1))});f.define_func("check_email",function(a){return/^[w-.d*]+@[wd]+(.w{2,4})$/.test(this.val(a,!1))});f.define_func("check_post",function(a){return/^[1-9]{1}[d]{5}$/.test(this.val(a,!1))});f.define_func("check_phone",function(a){return/^([0-9]{3,4}-)?[0-9]{7,8}$/.test(this.val(a,!1))});f.define_func("check_mobile",function(a){return/^[1]{1}[d]{10}$/.test(this.val(a,!1))});f.define_func("check_idcard",function(a){return/(^d{15}$)|(^d{18}$)|(^d{17}(d|X|x)$)/.test(this.val(a,
!1))});f.define_func("check_date",function(a){return/^((?!0000)[0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|30|31)$/.test(this.val(a,!1))});f.define_func("includes",function(a,c){return"string"!==typeof a?!1:a.includes(c)})})(RS2_CORE_DATA,RS2_UTIL);var RS2_CORE_STATE=function(f){return{create:function(a){function e(a){for(var b=0;b<x.length;++b){var c=x[b];if(a===c.qid)return b;if(c.type===RS2_T_GROUP&&(c=c.questions))for(var d=0;d<c.length;++d)if(a===c[d].qid)return b}}function c(b){if(a){a.clear_question(b.qid);for(var c=b.questions,d=0;d<c.length;++d)a.clear_question(c[d].qid)}b.updates={}}function d(a,b,d){a=x.splice(a+1,b);if(!0!==d)for(d=0;d<a.length;++d)c(a[d])}function b(a){l=RS2_S_EXIT;y=a||RS2_E_SUCCESS;a=u.length;n=0<a?u[a-1]:-1}
function z(a){0<=a&&a<u.length&&(l!==RS2_S_VIEWING&&(m=l),t=a,n=u[t],l=t===u.length-1?m||RS2_S_EDITING:RS2_S_VIEWING)}function E(a){n<a&&a<x.length?(0<x[a].repeat&&(a+=1),n=a,u.push(n),t=u.length-1,a=x[n],l=RS2_S_LOADED,a.lang=D):b()}function A(){l===RS2_S_LOADED&&0<u.length&&(u.pop(),t=u.length-1,c(x[n]))}function w(a,b){a=f.read(a,b.qid,[]);for(var c=b.prop,d=b.eid,g,B=0;B<a.length&&(g=a[B],g.qid!==b.qid||g.prop!==c||g.eid!==d);++B)g=void 0;if(g)if("value"===c)if(a=b.value,!0===b.update&&!0===g.update){b=
g.value;for(var l in a)b[l]=a[l]}else g.value=a;else g.value=b.value;else a.push(b)}function q(a,b,c){return a&&(a=a[b])?c.concat(a):c}var x=[],u=[],t=-1,n=-1,g,y=RS2_E_SUCCESS,l=RS2_S_NONE,m,D,F={};return{add_step:function(a){var b=[],c=a.questions;if(c)for(var d=0;d<c.length;++d){var g=c[d];b.push({defid:g,qid:g})}g=a.defid;x.push({defid:g,qid:g,type:a.type,questions:b,loaded:!1,updates:{}})},count:function(){return x.length},index:function(){return n},step:function(){if(0<=n&&n<x.length)return x[n]},
snapshot:function(){return{steps:x,history:u,htop:t,cur_step:n,paction:g,estatus:y,pstatus:l,saved_view_status:m,lang_index:D}},restore:function(a){x=a.steps;u=a.history;t=a.htop;n=a.cur_step;g=a.paction;y=a.estatus;l=a.pstatus;D=a.lang_index;m=a.saved_view_status},pstatus:function(){return l},estatus:function(){return y},has_prev:function(){return 0<t},prev_index:function(a){var b=0<t?t-1:-1;if(void 0!=a&&(a=e(a),void 0!=a))for(var c=0;c<u.length;++c)if(u[c]===a){b=c;break}return b},prev:function(a){void 0!=
a?z(a):0<t&&z(t-1)},next:function(){if(t<u.length-1)z(t+1);else if(g){switch(g.type){case RS2_P_EXIT:l===RS2_S_LOADED&&A(g.keep_value);b(g.status);break;case RS2_P_NEW:l===RS2_S_LOADED&&A(g.keep_value);var a=e(g.target),d=n+1;E(a);if(!0!==g.keep_value)for(;d<a;++d)c(x[d]);break;case RS2_P_SKIP:A(),E(n+1)}g=void 0}else l!==RS2_S_EXIT&&E(n+1)},do_repeat:function(a,b,c){a=e(a);if(a>=n){var g=x[a];0<g.repeat&&d(a,g.repeat,!0);if(0<b)for(g.repeat=b;0<b;--b){var m={defid:g.defid,qid:g.defid+"_"+b,type:g.type,
repeat_index:b-1,loaded:!1,updates:{}};c&&(m.repeat_param=c[b]);for(var B=[],C=0;C<g.questions.length;++C){var y=g.questions[C];B.push({defid:y.defid,qid:y.defid+"_"+b})}m.questions=B;x.splice(a+1,0,m)}else delete g.repeat;a===n&&l===RS2_S_LOADED&&this.set_skip()}},repeat_once:function(a){a=e(a);for(var b=x[a],c=b.repeat?b.repeat+1:1,d={defid:b.defid,qid:b.defid+"_"+c,type:b.type,repeat_index:c-1,loaded:!1,updates:{}},g=[],B=0;B<b.questions.length;++B){var C=b.questions[B];g.push({defid:C.defid,qid:C.defid+
"_"+c})}d.questions=g;x.splice(a+c,0,d);b.repeat=c;a===n&&l===RS2_S_LOADED&&this.set_skip()},end_repeat:function(a){for(var b=0,c=n+1;c<x.length;++c){var g=x[c];if(g.defid==a&&void 0!==g.repeat_index)++b;else break}0<b&&(d(n,b),g=x[e(a)],g.repeat-=b)},repeat_step:function(){if(0<=n&&n<x.length){var a=x[n];return a.defid!==a.qid}return!1},set_goto:function(a,b){g&&g.type==RS2_P_EXIT||"quotafail"==y||(g={type:RS2_P_NEW,target:a,keep_value:b})},set_jump:function(a,b,c){g&&g.type==RS2_P_EXIT||"quotafail"==
y||(this.reset_jump(),g={type:RS2_P_NEW,target:a,keep_value:c},c=x[n],c.jump_after=b,b=e(a),0<b&&(c=x[b],c.jump_before=a))},reset_jump:function(){if(g&&g.type==RS2_P_NEW){var a=x[n];delete a.jump_after;a=e(target);0<a&&(a=x[a],delete a.jump_before);g=void 0}},jumped:function(a){var b=x[n],c=b.questions,d=c.findIndex(function(b){return b.qid==a});return b.jump_after?(c=c.findIndex(function(a){return a.qid==b.jump_after}),0<=c&&d>c):b.jump_before?(c=c.findIndex(function(a){return a.qid==b.jump_before}),
0<=c&&d<c):!1},set_exit:function(a){g={type:RS2_P_EXIT,status:a}},set_estatus:function(a){y=a||RS2_E_SUCCESS},set_skip:function(){g={type:RS2_P_SKIP}},has_paction:function(){return void 0!==g},set_lang_index:function(a){D=a},lang_index:function(){return D},begin_editing:function(){var b=x[n];if(l===RS2_S_VIEWING||l===RS2_S_EXIT)0<=t&&(u=u.slice(0,t+1)),g=void 0,D=b.lang;l=RS2_S_EDITING;b=b.qid;var c=f.format_datetime(new Date);a&&(a.set_qprop(b,"st",c),a.update_qprop(b,"st",c))},end_editing:function(){l=
RS2_S_EDITED;var b=x[n].qid,c=f.format_datetime(new Date);a&&(a.set_qprop(b,"et",c),a.update_qprop(b,"et",c))},add_update:function(a){0<=n&&n<x.length?w(x[n].updates,a):0>n&&w(F,a)},updates:function(a){for(var b=q(F,a,[]),c=0;c<=t;++c)b=q(x[u[c]].updates,a,b);return b},editing_qid:function(a){return e(a)===n},history:function(){for(var a=[],b=0;b<u.length;++b){var c=x[u[b]],d={qid:c.qid,lang:c.lang};void 0!=c.repeat_index&&(d.repeat_index=c.repeat_index,d.defid=c.defid);a.push(d)}return a},last_step:function(){return n==
x.length-1}}}}}(RS2_UTIL);var RS2_CORE_SURVEY=function(f,a){function e(c,d,b,e){if(e)for(var f in e){var z=e[f],w=d[z];void 0!=w&&(c[a.key(b,z)]=a.copy_value(w))}else for(z in d)c[a.key(b,z)]=a.copy_value(d[z])}return{create:function(){function c(a){++G;return"__"+a+"_"+G}function d(b,c,d){b=a.key(b,c);c=F[b];c||(c=[],F[b]=c);c.push(d)}function b(a,b,c){if(b){var d=l[a];d||(d={},l[a]=d);d[b]=c}else l[a]=c}function z(a,b,g,l){if(l){var B=c(a+"_"+g);D[B]=l;d(b||a,g,B)}}function E(b,d,g,l,m){var B=c(b+"_text_eval");D[B]=function(c){var B=
m(c),C=a.key(d,g),n=c.qprop(b,C);l<n.length?(n[l]=B,c.action("setq",{target:b,attribute:C,value:n})):a.error(b+" : lang "+l+" out of range of prop "+g)};return B}function A(a,b){var c=[],d="";"string"===typeof a&&(d=a,a=[a]);for(var B=0;B<H.length;++B)a&&((v=a[B])||(v=a[H[B]])),!v&&b&&B<b.length&&(v=b[B]),c.push(v||d);return c}function w(b,c,g,l,m,n){var B=typeof m,C=m;if("function"===B&&c)g=E(c,g,l,n||0,m),d(b||c,"before",g),C="__";else if(n||"object"!==B)void 0===C&&(C="");else{n=[];if(a.isArray(m))for(C=
0;C<m.length;++C)n[C]=w(b,c,g,l,m[C],C);else for(C=0;C<H.length;++C)B=m[H[C]],n[C]=B?w(b,c,g,l,B,C):"";return n}return void 0!==n?C:[C]}function q(b,c,d,g,l,m){var B=[];g=g[l];for(var C=0;C<g.length;++C){var n=g[C],y=n.id,f=a.key(m,y);e(b,n,f,"visible has_input input_type group type res res_type category parentId order score minscale maxscale calc".split(" "));b[f+".title"]=w(c,d,y,"title",n.title);n.right_label&&(b[f+".right_label"]=w(c,d,y,"right_label",n.right_label));b[f+".maxdesc"]=w(c,d,y,"maxdesc",
n.maxdesc);b[f+".mindesc"]=w(c,d,y,"mindesc",n.mindesc);B.push(y)}b[a.key(m,l)]=B}function x(a,b){m.setup(a,m.instance("notnull",[b],void 0,b))}function u(a,b,c){m.setup(a,m.instance("selected",[b,c],void 0,c))}function t(b,c,d){for(var B=0;B<c.length;++B){var g=c[B];if(!0===g.has_input&&!0===g.required){var l=a.key(d,g.id);m.setup(b,m.instance("option_input_required",[l],"\u672c\u9898\u9009\u9879"+g.id+"\u5fc5\u586b\uff0c\u8bf7\u7b54\u5b8c\u518d\u8fdb\u5165\u4e0b\u4e00\u9875\uff01",l))}}}function n(b,
c,d,g){var B=!0===d.required;switch(c){case RS2_T_LABEL:case RS2_T_UNKNOWN:break;case RS2_T_DATETIME:B&&x(b,g);m.setup(b,m.instance("date",[],void 0,g));break;case RS2_T_SELECT:!g&&B&&u(b);t(b,d.options,g);break;case RS2_T_MULSELECT:!g&&B&&u(b);t(b,d.options,g);0<d.min&&m.setup(b,m.instance("selected_min",[d.min]));0<d.max&&m.setup(b,m.instance("selected_max",[d.max]));break;case RS2_T_ASSIGNMENT:d=d.options;for(c=0;c<d.length;++c){var l=d[c],C=l.required;(!0===C||B&&!1!==C)&&x(b,a.key(g,l.id))}break;
case RS2_T_SORT:B&&m.setup(b,m.instance("sorted_all",[d.max]));0<d.min&&m.setup(b,m.instance("sorted_min",[d.min]));break;case RS2_T_MATRIX:case RS2_T_MATRIX_SELECT:if(!g)for(g=d.rows,d=d.cols,c=0;c<d.length;++c){l=d[c];C=l.id;var y=l.required;if(!0===y||B&&!1!==y)for(y=0;y<g.length;++y){var e=RS2_QTYPE(l.type);e===RS2_T_SELECT||e===RS2_T_MULSELECT||e===RS2_T_DROPDOWN?u(b,C,g[y].id):n(b,e,l,a.key(g[y].id,l.id))}}break;default:B&&x(b,g)}}function g(c,d,l,y){var B=RS2_QTYPE(d.type),C=d.id,f=y?l:C;c[a.key(y,
"type")]=B;c[a.key(y,"title")]=w(l,C,void 0,"title",d.title);e(c,d,y,"visible disabled order style minscale maxscale min max layout col recording res res_type hint_hidden hscroll showid data dynamic search_data has_score calc hastown source".split(" "));d.right_label&&(c[a.key(y,"right_label")]=w(l,C,void 0,"right_label",d.right_label));c[a.key(y,"maxdesc")]=w(l,C,void 0,"maxdesc",d.maxdesc);c[a.key(y,"mindesc")]=w(l,C,void 0,"mindesc",d.mindesc);if(y)e(c,d,y,["has_input","input_type"]);else{c.defid=
C;c.required=d.required;c.hint=w(l,C,void 0,"hint",d.hint);var t=d.validators;if(t)for(var M=0;M<t.length;++M){var G=t[M],u=[],E=typeof G;if("string"===E)var A=G;else if("object"===E){A=G.id;u=G.params||[];var D=G.message;var x=G.option}A&&m.setup(C,m.instance(A,u,D,x))}n(C,B,d);z(C,l,"before",d.before);z(C,l,"after",d.after);z(C,void 0,"update",d.update)}switch(B){case RS2_T_LABEL:case RS2_T_MIXFILL:c.body=w(l,C,void 0,"body",d.body);break;case RS2_T_SELECT:case RS2_T_MULSELECT:case RS2_T_SORT:case RS2_T_ASSIGNMENT:case RS2_T_DROPDOWN:case RS2_T_SCALE_MUL:q(c,
l,C,d,"options",y);C=d.options;for(d=0;d<C.length;++d)if(t=C[d],l=a.key(y,t.id),B===RS2_T_SELECT){if(!0===t.selected){b(f,l,"1");break}}else B===RS2_T_MULSELECT?!0===t.selected&&b(f,l,"1"):B===RS2_T_ASSIGNMENT&&(t=t.value)&&b(f,l,t);break;case RS2_T_AUTOCOMPLETE:c[a.key(y,"options")]=d.options;break;case RS2_T_MATRIX:case RS2_T_MATRIX_SELECT:if(void 0===y){q(c,l,C,d,"rows");y=[];f=d.cols;for(B=0;B<f.length;++B)d=f[B],g(c,d,C,d.id),y.push(d.id);c.cols=y}break;default:(B=d.value)&&b(f,y,B)}return c}
var y={},l={},m=f.create(),D={},F={},G=0,H=["zh"],I=[],J=!1,K=!1;return{add_page:function(b){var c={};g(c,b);0<I.length&&(c.sections=a.copy_array(I));var d=c.defid,B=c.type;y[d]=c;if(B===RS2_T_GROUP){B=b.questions;b=[];for(var l=0;l<B.length;++l){var m={};g(m,B[l],d);var n=m.defid;y[n]=m;b.push(n)}c.questions=b}return c},option_props:function(a,b){var c={};q(c,a,a,{options:b},"options");return c},add_rule:function(a,b){z(a,void 0,"rule",b)},add_validator:function(a){m.define(a)},add_filter:function(b,
d,g){var B=c(b+"_"+d);b=a.key(b,d);D[B]=g;g=F[b];g||(g=[],F[b]=g);g.push(B)},begin_section:function(a){a.title=A(a.title);I.push(a)},end_section:function(){I.pop()},text_value:A,set_langs:function(a){H=a},langs:function(){return H},lang_index:function(a){for(var b=0;b<H.length;++b)if(H[b]===a)return b},has_filters:function(b,c){if(K&&"survey"!=b)return!1;b=F[a.key(b,c)];return void 0!==b&&0<b.length},exec_filters:function(b,c,d){if(!K||"survey"==b)if(b=F[a.key(b,c)])for(c=0;c<b.length;++c){var g=
b[c],l=D[g];if(l)try{a.debug("exec filter "+g),l(d)}catch(N){a.error("["+d.qid+"] Failed to exec filter "+g,N)}else a.error("Can't find filter "+g)}},validate:function(a,b,c){var d=[];J||(d=m.validate(a,b,c));if(0<d.length)for(a=d,b=0;b<a.length;++b)if(c=a[b],"object"==typeof c){for(var g=[],l=c.zh,B=0;B<H.length;++B)g.push(c[H[B]]||l);a[b]=g}return d},disable_validation:function(a){J=a},disable_filters:function(a){K=a},create_qprops:function(b,c){if(b=y[b]){var d=a.copy_obj(b);void 0!==b.questions&&
(d.questions=a.copy_array(b.questions));d.qid=c;return d}},def_qval:function(b,c){var d=y[b];if(b=l[b]){var g=typeof b;var B=d.type;if(B===RS2_T_MATRIX||B===RS2_T_MATRIX_SELECT)for(g={},d=d.rows,B=0;B<d.length;++B)e(g,b,a.key(c,d[B]));else"object"===g?(g={},e(g,b,c)):g=b}return g}}}}}(RS2_CORE_VLDT,RS2_UTIL);var RS2_CORE_SURVEY_CTRL=function(f,a,e,c,d,b){var z={};return{create:function(){function c(a,c){var d=z[a];if(d)for(var g=0;g<d.length;++g){var B=d[g];if(B)try{B(m,l,c)}catch(N){b.error("Failed to call extensions of event "+a,N)}}}function A(){var a=RS2_P_NOACTION,b,c=[],d={},g=[],n=!1,e=!1,f={};return{set_edit:function(a,c){e=a;b=c},set_vldt_result:function(b,c){if(c&&0<c.length){a=RS2_P_INVALID;var d=l.sys_vval("lang");if(void 0!=d&&"all"!=d&&(d=y.langs(),c&&d&&1<d.length)){var g=0;for(j=0;g<c.length;++g){var B=
c[g];if("string"==typeof B){var m=[];for(j=0;j<d.length;++j)m.push(B);c[g]=m}}}f[b]=c}},valid:function(){return a!==RS2_P_INVALID},add_alert:function(b){a=RS2_P_ALERT;c.push(b)},has_alert:function(){return a===RS2_P_ALERT},result:function(){var B={survey:d,page:a,page_updated:n,target:b};0<c.length&&(B.alerts=c);e&&0<g.length&&(B.question=g);if(a===RS2_P_EDITED||a===RS2_P_NEW){var y={qid:b,has_prev:m.has_prev(),index:m.index(),total:m.count(),exit:m.pstatus()===RS2_S_EXIT,last_step:m.last_step()},
C=l.qprops(b);C&&(y.recording=C.recording);B.nav=y}else a===RS2_P_INVALID&&(B.messages=f);return B},set_paction:function(c,g,l){if(l)a=RS2_P_NEW,b=g,c===RS2_S_EXIT&&(d.exit=!0);else switch(c){case RS2_S_VIEWING:a=RS2_P_EDITED;b=g;break;case RS2_S_EXIT:a=RS2_P_EXIT;d.exit=!0;break;case RS2_S_EDITING:a=RS2_P_NEW;b=g;break;default:a=RS2_P_NOACTION}},set_pupdate:function(a){n=!0;b=a},add_qupdate:function(a,b){m.editing_qid(a.qid)?(l.apply_updates(a.qid,[a]),e&&("value"!==a.prop&&"options"!==a.prop&&(a.value=
l.qprop(a.qid,a.eid,a.prop)),g.push(a))):m.add_update(a)},add_supdate:function(a,b){a&&(d[a]=b)}}}function w(a,b,c){var d=l.qprops(b),g=l.qval(b);d||(d=y.create_qprops(a,b),l.set_qprops(b,d));g||l.set_qval(b,y.def_qval(a,b));c&&0<c.length&&(l.apply_updates(b,c),d=l.qprops(b));return d}function q(a){var b=a.qid,c=a.defid;if(b!==c){var d={};d[c]=b;void 0!=a.repeat_index&&(d.repeat=a.repeat_index);a.repeat_param&&(d.param=a.repeat_param);a=a.questions;for(c=0;c<a.length;++c){var g=a[c];d[g.defid]=g.qid}}F=
l.env(b,d)}function x(){m.next();if(m.pstatus()===RS2_S_LOADED){var a=m.step(),b=a.defid;q(a);for(var c=a.qid,d=w(a.defid,c,m.updates(c)),g=a.questions,l=0;l<g.length;++l){var n=g[l];c=n.qid;d.questions[l]=c;w(n.defid,c,m.updates(c))}c=F;if(y.has_filters("survey","each"))if((a=a.questions)&&0<a.length)for(d=0;d<a.length;++d)y.exec_filters("survey","each",c.extend(a[d].qid));else y.exec_filters("survey","each",c);y.exec_filters(b,"before",F);m.has_paction()?x():m.begin_editing()}}function u(a,b){H[a]=
b}function t(a,b){for(var c=0;c<a.length;++c)I[a[c]]=b}function n(a,b,c){a=y.create_qprops(a,b);if(c)for(var d in c)a[d]=c[d];return a}function g(a,b){var c=void 0;if(b){var d=b.history;b=b.steps;c={};if(d)for(var g=0;g<d.length;++g){var l=b[d[g]],m=l.qid,y=n(l.defid,m,a[m]);c[m]=y;if(l=l.questions)for(m=0;m<l.length;++m){var B=l[m],e=B.qid;c[e]=n(B.defid,e,a[e]);y.questions[m]=e}}}return c}var y=f.create(),l=a.create(),m=e.create(l),D,F,G={languages:["zh"]};RS2_CORE_DATA.define_func("history",function(){return m.history()});
var H={},I={};l.define_func("action",function(a,b){(a=I[a])&&a(b,this,D)});t(["setquestion","setq"],function(a,b,c){var d=b.resolve(a.target),g=a.option,m=a.attribute;a=a.value;if(d){d=b.resolve(d);b={qid:d,eid:g,prop:m,value:a};if("value"===m){m=void 0!==g;"number"===typeof a&&(a=a.toString());var n=a;m&&(n={},n[d+"."+g]=a);b.value=n;b.update=m;l.input(d,n,m)}else if("title"===m||"hint"===m)b.value=y.text_value(b.value,l.qprop(d,g,m));c.add_qupdate(b)}});t(["updateq"],function(a){var b=a.target;
b&&(l.set_qprop(b,a.attribute,a.value),l.update_qprop(b,a.attribute,a.value))});t(["setrow"],function(a,b,c){a.option=a.row;(c=I.setq)&&c(a,b,D)});t(["setoption"],function(a,b,c){b=b.resolve(a.target);var d=a.option,g=a.attribute;a=a.value;if(b){var m={qid:b,eid:d,prop:g,value:a};"title"===g||"hint"===g?m.value=y.text_value(m.value,l.qprop(b,d,g)):"options"===g?"object"===typeof a&&(m.value=y.option_props(b,a)):"value"===g&&(g={},g[b+"."+d]=a,m.update=!0,m.value=g);c.add_qupdate(m)}});t(["select-options"],
function(a,b,c){var d=b.resolve(a.target);if(d){c.add_qupdate({qid:d,prop:"clear"});var g=a.clear;if(g)for(var l=0;l<g.length;++l)c.add_qupdate({qid:g[l],prop:"clear"});g=a.value;if(void 0===g&&(a=a.parent))if(b=b.val(a),"object"===typeof b)for(k in b)"1"==b[k]&&(g=k.substr(a.length+1));else g=b;c.add_qupdate({qid:d,prop:"option_category",value:g})}});t(["setvariable"],function(a){var b=a.id;b&&l.set_vval(b,a.value)});t(["setlang"],function(a,b,c){a=a.value;l.set_sys_vval("lang",a);c.add_supdate("lang",
void 0===a?"all":a)});t(["alert"],function(a,b,c){c.add_alert(a.message)});t(["clear"],function(a,b,c){var g=a.target,m=a.col;a=a.row;if(g){g=b.resolve(g);b={qid:g,prop:"clear",col:m,row:a};if(void 0===m&&void 0===a)l.set_qval(g,void 0);else if((g=l.qval(g))&&"object"===typeof g)for(var n in g){var y=d.option_key(n);void 0!==m&&y.col!==m||void 0!==a&&y.row!==a||(g[n]=void 0)}c.add_qupdate(b,!0)}});t(["goto"],function(a,b){var c=a.target;c&&m.set_jump(c,b.qid,a.keep_value)});t(["exit"],function(a,
b,c){b=a.status;a=a.message;"quotafail"==b&&void 0==a&&(a="\u95ee\u5377\u914d\u989d\u5df2\u6ee1\uff0c\u60a8\u4e0d\u7b26\u5408\u6211\u4eec\u7684\u8c03\u67e5\u9700\u6c42\uff0c\u611f\u8c22\u60a8\u7684\u914d\u5408\uff0c\u795d\u60a8\u751f\u6d3b\u6109\u5feb\uff01");a&&c.add_alert(a);m.set_exit(b)});t(["skip"],function(a){m.pstatus()===RS2_S_LOADING&&m.set_skip(a.keep_value)});t(["repeat"],function(a,c,d){d=c.resolve(a.target);var g=a.refresh;a=a.param;var n=d+"_repeated",y=l.sys_vval(n);if(!0===g||!0!==
y)"string"===typeof a&&(a=c.val(a)),d&&void 0!==a&&!m.repeat_step()&&(b.isArray(a)?(m.do_repeat(d,a.length,a),l.set_sys_vval(n,!0)):"number"===typeof a&&(m.do_repeat(d,a),l.set_sys_vval(n,!0)))});t(["repeat-once"],function(a,b,c){(a=a.target)&&m.repeat_once(a)});t(["end-repeat"],function(a,b,c){(a=a.target)&&m.end_repeat(a)});t(["put-extra"],function(a){l.set_sys_vval("submit_extra",a.value)});t(["put-tag"],function(a){a=a.target;var b=l.qprops(a);if(b){var c=l.qval(a);if(c)switch(b.type){case RS2_T_INTEGER:case RS2_T_FLOAT:case RS2_T_TEXT:case RS2_T_TEXTAREA:case RS2_T_DATETIME:case RS2_T_RATING:case RS2_T_SCALE:var d=
c;break;case RS2_T_LOCATION:d=c.poi;break;case RS2_T_PROVCITY:d=c[a+".prov"]+c[_qid+".city"]+c[_qid+".dist"];break;case RS2_T_SELECT:case RS2_T_MULSELECT:case RS2_T_DROPDOWN:if("object"===typeof c)for(k in b=a+".",c)if("1"==c[k]){var g=k.substr(b.length);g=l.qprop(a,g,"title");void 0!==g&&(g=g[0],d=void 0===d?g:d+","+g)}break;case RS2_T_AUTOCOMPLETE:d=c.name}c=l.sys_vval("sys_tags");void 0===c&&(c={},l.set_sys_vval("sys_tags",c));c[a]=d}});t(["set_visible"],function(a,b,c){if(a)for(var d in a){b=
a[d];c.add_qupdate({qid:d,prop:"interviewer_visible",value:b});var g=l.qprops(d);g&&(g.interviewer_visible=b)}});u("edited",function(a,c){var d=a.qid;D.set_edit(!0,d);c=m.step();m.pstatus()!==RS2_S_EDITING&&(m.begin_editing(),D.set_pupdate(c.qid),q(c));d&&(l.input(d,a.value,a.update),c=F.extend(d),a=c.qprop(d,"defid"),D.set_vldt_result(d,y.validate(a,c,!1)),D.valid()&&(b.debug("edited: "+d+" = ",l.qval(d)),y.exec_filters(a,"update",c)))});u("prev",function(a){a=m.prev_index(a?a.qid:void 0);if(0<=
a){m.prev(a);var b=m.step();a=b.qid;w(b.defid,a,[],!1);b=b.questions;for(var c=0;c<b.length;++c){var d=b[c];a=d.qid;w(d.defid,a,[],!1)}a=m.pstatus();if(a===RS2_S_EDITING||a===RS2_S_EXIT)a=RS2_S_VIEWING;D.set_paction(a,m.step().qid)}});u("remark",function(a){if(a){var b="remark";!0===a.input&&(b="remark.input");l.set_qprop(a.qid,b,a.value);l.update_qprop(a.qid,b,a.value)}});u("next",function(a){a=m.pstatus();if(a===RS2_S_EDITING){a=m.step();var b=a.qid,d=a.defid,g=F,l=D,n=a.questions;if(n)for(var e=
0;e<n.length;++e){var f=n[e].qid;l.set_vldt_result(f,y.validate(n[e].defid,g.extend(f),!0))}f=a.qid;l.set_vldt_result(f,y.validate(a.defid,g.extend(f),!0));D.valid()&&(m.end_editing(),y.exec_filters(d,"rule",F),m.pstatus()!==RS2_S_EXIT?(y.exec_filters(d,"after",F),c("page_finished",b),x()):c("page_finished",b),D.set_paction(m.pstatus(),m.step().qid))}else a===RS2_S_VIEWING&&m.next(),D.set_paction(a,m.step().qid)});u("start",function(a){var c=a.data,d=a.state,g=a.variables,n=a.externs;a=a.interview||
{};var e=a.edit_type||RS2_I_EDIT_INTERVIEW;switch(e){case RS2_I_EDIT_PREVIEW:y.disable_filters(!0);case RS2_I_EDIT_VIEW:y.disable_validation(!0)}c&&K.setup_data(c,d);if(g)if(b.isArray(g))for(c=0;c<g.length;++c)l.setup_vars(g[c]);else l.setup_vars(g);if(n)if(b.isArray(n))for(c=0;c<n.length;++c)l.setup_externs(n[c]);else l.setup_externs(n);d?(K.restore(d),q(m.step()),e!==RS2_I_EDIT_INTERVIEW&&(d=0,a.qid&&(d=m.prev_index(a.qid)||0),m.prev(d)),y.exec_filters("survey","before",F)):(F=l.env("survey",{}),
y.exec_filters("survey","before",F),x());(d=a.lang)&&l.set_sys_vval("lang",d);D.set_paction(m.pstatus(),m.step().qid,!0);D.add_supdate("lang",l.sys_vval("lang"))});var J={page:function(a){(a=y.add_page(a,l))&&m.add_step(a)},rule:function(a,b){y.add_rule(a,b)},validator:function(a){y.add_validator(a)},languages:function(a){a&&0<a.length&&(G.languages=a,y.set_langs(a))},begin_section:function(a){y.begin_section(a)},end_section:function(){y.end_section()},variables:function(a,b){l.setup_vars(a,b)},ref:function(a){return l.vval(a)},
properties:function(a){if(a)for(var b in a)G[b]=a[b]},survey_filter:function(a,b){y.add_filter("survey",a,b)}},K={load:function(a,b){a(J,b)},restore:function(a){m.restore(a)},state:function(){return m.snapshot()},setup_data:function(a,b){l.setup_vars(a.var_dict);l.setup_qvals(a.value_dict);l.setup_qdata(g(a.prop_dict,b));l.setup_qeditdata(a.prop_dict)},data:function(){return{var_dict:l.submit_vars(),value_dict:l.qvals(),prop_dict:l.qprops_updated(),history:m.history(),estatus:m.estatus()}},start:function(a,
b,c,d){this.event({name:"start",param:{state:a,data:b,variables:c,externs:d}})},disable_validation:function(a){y.disable_validation(a)},survey_props:function(){return G},event:function(a){var d=a?a.name:void 0;D=A();if(d){var g=H[a.name];if(g)try{g(a.param)}catch(L){b.error("Failed to handler event "+d,L)}}a=D.result();D=void 0;m.pstatus()==RS2_S_EXIT&&c("survey_finished");return a},page:function(){var a={},b=m.step();if(b){var c=b.qid;a.qid=c;var d=[],g={},n={},y=l.qprops(c);if(b.type===RS2_T_GROUP){b=
{title:y.title,hint:y.hint};c=y.questions;for(var e=0;e<c.length;++e){var f=c[e];m.jumped(f)||(d.push(l.qprops(f)),g[f]=l.qval(f),l.put_qvars(n,f))}}else b={},g[c]=l.qval(c),d.push(y),l.put_qvars(n,c);b.remark=y.remark;b.remark_input=y["remark.input"];b.sections=y.sections;b.has_prev=m.has_prev();b.index=m.index();b.total=m.count();b.exit=m.pstatus()===RS2_S_EXIT;b.last_step=m.last_step();b.lang=m.lang_index();b.recording=y.recording;a.page=b;a.questions=d;a.values=g;a.vars=n}return a},page_history:function(){for(var a=
[],b=m.history(),c=0;c<b.length;++c){var d=b[c].qid,g={},n=l.qprops(d);g.title=n.title;g.hint=n.hint;g.sections=n.sections;a.push({qid:d,page:g})}return a}};return K},on_event:function(a,b){var c=z[a];c||(c=[],z[a]=c);c.push(b)}}}(RS2_CORE_SURVEY,RS2_CORE_DATA,RS2_CORE_STATE,RS2_CORE_VLDT,RS2_CORE_EXPR,RS2_UTIL);(function(f,a){function e(a,d){var b=0;if(!0===a.qprop(d,void 0,"has_score")&&!1!==a.qprop(d,void 0,"visible")){b=a.qval(d);var c=0,e=d.length+1;if("object"===typeof b)for(k in b)if("1"==b[k]){var f=k.substr(e);c+=a.qprop(d,f,"score")||0}b=c}return b}f.on_event("survey_finished",function(a,d){a=a.history();for(var b=0,c=0;c<a.length;++c){var f=a[c].qid;if(d.qprop(f,"type")===RS2_T_GROUP){f=d.qprop(f,"questions");for(var A=0;A<f.length;++A)b+=e(d,f[A])}else b+=e(d,f)}d.set_sys_vval("survey_score",
b)})})(RS2_CORE_SURVEY_CTRL,RS2_CORE_DATA);var RS2_UI_HTML=function(){function f(a,d){if(a){a=a.split("");for(var b=!1,c=[],e=0;e<a.length;++e){var f=a[e];"0"<=f&&"9">=f?c.push(f):"-"===f&&0===e?c.push(f):!0===d&&0<e&&"."===f&&!b&&(b=!0,c.push(f))}return c.join("")}return a}var a=!1,e=null;return{idname:function(){for(var a,d=0;d<arguments.length;++d){var b=arguments[d];b&&(a=a?a+"_"+b:b)}return a},tag:function(a,d,b){a=$(a).appendTo(d);b&&a.addClass(b);return a},div:function(a,d){return this.tag("<div>",a,d)},update_visible:function(a,d){d?
a.show():a.hide()},ctrl_form:function(a,d){a=$("<form>").attr("onsubmit","return false;").addClass("rs2_ctrl_wrap").appendTo(a);d&&a.addClass(d);return a},texts:function(a,d,b,e){a=$("<div>").addClass("rs2_text_wrap").appendTo(a);d&&this.show_texts(a,d,b,e);return a},show_texts:function(a,d,b,e){a.show();a.empty();if(d)for(var c=0;c<d.length;++c){var f=d[c];b&&(f=b+f);e&&(f+=e);$("<div>").addClass("rs2_text_item").addClass("rs2_lang_"+c).html(f).appendTo(a)}},show_inline_texts:function(a,d,b,e){a.show();
a.empty();if(d)for(var c=0;c<d.length;++c){var f=d[c];b&&(f=b+f);e&&(f+=e);$("<span>").addClass("rs2_text_item").addClass("rs2_lang_"+c).css({display:"inline"}).html(f).appendTo(a)}},media_res:function(a,d,b){var c;"img"==b?c=$("<img>"):"audio"==b||"voice"==b?c=$("<audio>").attr("controls","controls").text("\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 audio \u6807\u7b7e\u3002"):"video"==b&&(c=$("<video>").attr("controls","controls").text("\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 video \u6807\u7b7e\u3002"));
c&&c.attr({alt:"",src:d}).addClass("rs2_ctrl_media").appendTo(a);return c},checkbox:function(a,d,b,e,f,A){var c=this.div(a,"rs2_ctrl_checkbox");this.div(c,d?"rs2_ctrl_radio_btn":"rs2_ctrl_checkbox_btn");!1!==b&&this.texts(c,b);f&&this.media_res(c,f,A);c.on("click",function(){!0!==c.hasClass("rs2_ctrl_disabled")&&e()});return c},disable_checkbox:function(a,d){d?a.addClass("rs2_ctrl_disabled"):a.removeClass("rs2_ctrl_disabled")},option_checkbox:function(a,d){var b=a;void 0!=d&&(b=this.option_elem(a,
d));return $(".rs2_ctrl_checkbox",b)},select_option:function(a,d,b){return $("<option>").text(d).attr("value",b).appendTo(a)},option_elem:function(a,d,b){a=$(".rs2_ctrl_option[rs2-data-option='"+d+"']",a);return b?$(b,a):a},set_option_cat:function(a,d){void 0!==d&&a.attr("rs2-data-option-cat",d)},has_option_cat:function(a,d){return void 0!==a?a.attr("rs2-data-option-cat")==d:!1},select_options:function(a,d){$(".rs2_ctrl_option",a).hide();$(".rs2_ctrl_option[rs2-data-option-cat='"+d+"']",a).show()},
option_builder:function(a,d){return{create:function(b){return $("<"+d+">").attr("rs2-data-option",b).appendTo(a)},elem:function(b,c){b=$(d+"[rs2-data-option='"+b+"']",a);return c?$(c,b):b},each:function(b){$(d+"[rs2-data-option]",a).each(function(){var a=$(this);b(a,a.attr("rs2-data-option"))})}}},align_table:function(a,d){a=a.get(0).rows;d=d.get(0).rows;for(var b=Math.min(a.length,d.length),c=0;c<b;++c){var e=$(a[c]),f=$(d[c]);h=Math.max(e.height(),f.height());e.height(h);f.height(h)}},scrollbarWidth:function(){null==
a&&(a=!1);if(null!=e&&!a)return e;if("loading"===document.readyState)return null;var c=document.createElement("div");var d=document.createElement("div");c.style.width=d.style.width=c.style.height=d.style.height="100px";c.style.overflow="scroll";d.style.overflow="hidden";var b=document.body;b||(b=document.getElementsByTagName("body")[0]);b&&(b.appendChild(c),b.appendChild(d),e=Math.abs(c.scrollHeight-d.scrollHeight),b.removeChild(c),b.removeChild(d));return e},stylesheet:function(a){for(var c=0;c<
document.styleSheets.length;c++){var b=document.styleSheets[c];if(b.title===a)return b}},add_stylesheet:function(a){var c=document.createElement("style");c.setAttribute?(c.setAttribute("title",a),c.setAttribute("type","text/css")):(c.title=a,c.type="text/css");c.styleSheet?c.styleSheet.cssText="":c.appendChild(document.createTextNode(""));document.getElementsByTagName("head")[0].appendChild(c);return c.sheet},css_rule:function(a,d){a=a.cssRules||a.rules;for(var b=0;b<a.length;++b){var c=a[b];if(c.selectorText===
d)return c}},add_css_rule:function(a,d,b){var c=0<(a.cssRules||a.rules).length?1:0;a.insertRule?a.insertRule(d+" { "+b+" } ",c):a.addRule&&a.addRule(d,b,c)},set_css_rule:function(a,d,b){var c=this.css_rule(a,d);c?c.style.cssText=b:this.add_css_rule(a,d,b)},illegal_char_keypress:function(a){switch(a.keycode||a.which){case 34:case 39:return!1;default:return!0}},text_val:function(a,d){var b=a.val();if(b){switch(d){case RS2_T_INTEGER:b=f(b);break;case RS2_T_FLOAT:b=f(b,!0);break;default:b=b.replace(/'|"/g,
"")}a.val(b)}return b},filter_illegal_char:function(a){a.on("keypress",function(a){switch(a.keycode||a.which){case 34:case 39:return!1;default:return!0}})},number_input_keypress:function(a,d,b){if(8==[a.keyCode||a.which])return!0;if(45==[a.keyCode||a.which])return 0<d.length?a.returnValue=!1:!0;if(46==[a.keyCode||a.which])return b?-1<d.indexOf(".")?a.returnValue=!1:!0:a.returnValue=!1;if(48>[a.keyCode||a.which]||57<[a.keyCode||a.which])return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}}}();var RS2_UI_WEB_REMARK=function(f){function a(a,c,e){var b=f.ctrl_form(a,"rs2_ctrl_remark");f.tag("<button>",b).text("\u5907\u6ce8").on("click",function(){z.toggle()});var z=f.tag("<textarea>",b).blur(function(){var a=f.text_val($(this));e.event_ui(RS2_M_UI_COMMENT,void 0,a);e.event({name:"remark",param:{qid:c,value:a}})});!0===e.remark.hidden&&b.hide();return{update_value:function(a,b){var c=a.remark;c&&0<c.length?z.val(c):d.remark_collapsed(a,b)&&z.hide()},on_ui_event:function(a){},toggle:function(){b.toggle()}}}
function e(a,c,e,A,w){var b=f.ctrl_form(c,"rs2_ctrl_remark").addClass("rs2_ctrl_remark"),z;f.tag("<button>",b).text("\u5907\u6ce8").on("click",function(){u.toggle();z&&z.toggle()});var u=$("<select>").appendTo(b).change(function(){var a=$(this).val();A.event_ui(RS2_M_UI_COMMENT,void 0,a);A.event({name:"remark",param:{qid:e,value:a}})});$("<option>").attr({value:"",disabled:"disabled",selected:"selected"}).text("\u8bf7\u9009\u62e9").appendTo(u);for(c=0;c<a.length;++c){var t=a[c];$("<option>").attr("value",
t.id).text(t.title).appendTo(u)}w&&(z=f.tag("<textarea>",b).blur(function(){var a=f.text_val($(this));A.event_ui(RS2_M_UI_COMMENT,void 0,a);A.event({name:"remark",param:{qid:e,input:!0,value:a}})}));!0===A.remark.hidden&&b.hide();return{update_value:function(a,b){var c=a.remark,g=a.remark_input;c&&0<c.length?u.val(c):g&&0<g.length?z&&z.val(g):d.remark_collapsed(a,b)&&(u.hide(),z&&z.hide())},on_ui_event:function(a){},toggle:function(){b.toggle()}}}function c(a,c){return{update_value:function(a){},
update_visible:function(a,b){},clear:function(a){},on_ui_event:function(a){},toggle:function(){}}}var d={create:function(b,f){var z=d.survey_remark_flag(b,f);f={create:c,has_remark:z!==RS2_I_REMARK_NONE,has_page_remark:z===RS2_I_REMARK_PAGE,has_question_remark:z===RS2_I_REMARK_QUESTION,hidden:!0===b.remark_hidden};z!==RS2_I_REMARK_NONE&&(z=b.remark_type,"input"===z?f.create=a:"dropdown"===z?f.create=function(a,c,d){return e(b.remark_options,a,c,d,!1)}:"dropdown_input"===z&&(f.create=function(a,c,
d){return e(b.remark_options,a,c,d,!0)}));return f},survey_remark_flag:function(a,c){a=a.remark_style;return"question"===a?RS2_I_REMARK_QUESTION:"page"===a?RS2_I_REMARK_PAGE:RS2_I_REMARK_NONE},remark_collapsed:function(a,c){return!0}};return d}(RS2_UI_HTML);var RS2_UI_WEB_VIEW=function(f,a,e){function c(a,c,d){var g=d.qprop("layout");switch(c){case RS2_T_SELECT:"horizental"==g&&(c=RS2_T_SELECT_H);break;case RS2_T_MULSELECT:"horizental"==g&&(c=RS2_T_MULSELECT_H);break;case RS2_T_MATRIX:"fixed-row-title"===g&&(c=RS2_T_MATRIX_FIXEDCOL);break;case RS2_T_MATRIX_SELECT:"fixed-row-title"===g?c=RS2_T_MATRIX_SELECT_FIXEDCOL:"compact-row-title"==g&&(c=RS2_T_MATRIX_SELECT_COMPACT)}(g=b[c])||(g=b[RS2_T_UNKNOWN]);if(g)try{return g.create(a,d)}catch(l){e.error("Failed to create ctrl "+
c,l)}}function d(b){var d=Object.create(b);d.extend=function(a,b,c){var d=Object.create(this);a&&(d.question=a,d.qid=a.qid);c&&(d.row=c);b&&(d.col=b);return d};d.lang=function(a,b){var c;try{if(w&&A){var d=w[A];d&&(c=d[a])}}catch(D){}void 0==c&&(c=b||a);return c};d.create_ctrl=c;d.embeded=function(){return void 0!==this.row};d.qprop=function(a,b){if(this.question)return this.question[this.propid(a,b)]};d.replace_var=function(a,b){this.vars&&"string"===typeof a&&(a=this.vars[a]);void 0===a&&(a=b);
return a};d.propid=function(a,b){return e.key(this.col,a,b)};d.dataid=function(a,b){return e.key(this.qid,this.row,this.col,a,b)};d.tagid=function(b,c){return a.idname(this.qid,this.row,this.col,b,c)};d.event_edited=function(a,c,d,m){var g=a;this.row&&("object"!==typeof a&&(g={},g[this.dataid(d)]=a),c=!0);b.event_edited(this.qid,g,c,m)};d.event_ui_edited=function(a,c){b.event_ui({type:RS2_M_EDITED,qid:this.qid,prop:"value",value:a,update:c})};d.update_value=function(a){return this.row&&a?a[this.dataid()]:
a};d.event_ui=function(a,c,d,m){a={type:RS2_M_UI,action:a,option:c,value:d};a.qid=this.qid;m?a.vprefix=m:this.row&&(a.vprefix=e.key(this.row,this.col));b.event_ui(a)};d.option_cat=function(a){return this.qprop(a,"parentId")};return d}var b={},z,E=["zh"],A,w,q=function(b,d,g,f){var l=$("<div>").css({width:"100%"}),m=b.qid,n=$("<div>").addClass("rs2_q_header").css({width:"auto"}).appendTo(l),y=void 0;!0===b.required&&(y="<span class='re2_q_required'>\uff08\u5fc5\u586b\uff09</span>");var t=a.texts(n,
b.title,!1!==b.showid?m+". ":"",y).addClass("rs2_q_title");b.res&&a.media_res(n,b.res,b.res_type);var q=!0===g.qprop("hint_hidden");if(q)var u=a.tag("<button>",$("<div>").appendTo(n)).addClass("rs2_q_hint_btn").text("\u63d0\u793a").on("click",function(){z.is(":hidden")?(z.show(),u.text("\u9690\u85cf")):(z.hide(),u.text("\u63d0\u793a"))});var z=a.texts(n,b.hint).addClass("rs2_q_hint");(q||e.empty_texts(b.hint))&&z.hide();var w=a.div(l,"rs2_q_message").hide(),x=g.view_mode,A=c(l,b.type,g);A&&(A.update_value(d,
!1),!0===x&&A.update_disabled&&A.update_disabled(void 0,!0));if(g.remark.has_question_remark){var E=g.remark.create(l,m,g);E.update_value(b,d)}f||$("<div>").addClass("rs2_p_sep").appendTo(l);var L={qid:m,show:function(a,b){l.appendTo(a);if(A.on_showed)A.on_showed()},show_message:function(b){w.empty();if(b){w.show();for(var c=0;c<b.length;++c){var d=b[c];"string"==typeof d&&(d=[d]);a.texts(w,d).addClass("rs2_q_error")}l.addClass("rs2_q_haserror")}else l.removeClass("rs2_q_haserror"),w.hide()},remove:function(){l.detach()},
update:function(a){var b=a.prop;if("value"===b)A.update_value(a.value,a.update);else if("clear"===b)A.clear(a);else{var c=a.eid;c||e.dispatch_func(L,"update_",[b,a.value]);e.dispatch_func(A,"update_",[b,c,a.value])}},update_title:function(b){a.show_texts(t,b,m+". ",y)},update_hint:function(b){a.show_texts(z,b)},update_visible:function(a){!1===a?l.hide():l.show()},update_disabled:function(a){!0!==x&&A.update_disabled&&A.update_disabled(void 0,a)},on_ui_event:function(a){if((!a||a.action!==RS2_M_UI_COMMENT)&&
A&&A.on_ui_event)A.on_ui_event(a)},toggle_remark:function(a){E&&E.toggle()}};return L},x=function(a,b){var c=[],d=a.qid;b.vars=a.vars;for(var l=a.questions.length,m=0;m<l;++m){var f=a.questions[m],e=q(f,a.values[f.qid],b.extend(f),m===l-1);c.push(e);!0===f.disabled&&e.update_disabled(!0);!1!==f.interviewer_visible&&!1!==f.visible||e.update_visible(!1)}if(b.remark.has_page_remark){var n=$("<div>").addClass("rs2_p_remark");1==a.questions.length?(e=a.questions[0],l=e.qid,b=b.remark.create(n,l,b),b.update_value(e,
a.values[l])):(b=b.remark.create(n,d,b),b.update_value(a.page,void 0))}return{pid:d,exit:a.page.exit,show:function(b,d){b.show_page(a.page,d);for(d=0;d<c.length;++d)c[d].show(b.content);n&&n.appendTo(b.content);b.update_exit(this.exit||a.page.last_step)},show_messages:function(a){for(var b=0;b<c.length;++b){var d=c[b],g=a[d.qid];g&&d.show_message(g)}},clear_messages:function(a){for(var b=0;b<c.length;++b){var d=c[b];void 0!==a&&a!=d.qid||d.show_message()}},remove:function(){for(var a=0;a<c.length;++a)c[a].remove();
n&&n.detach()},update:function(a,b){var g;a:{for(g=0;g<c.length;++g){var l=c[g];if(l.qid===a.qid){g=l;break a}}g=void 0}g?g.update(a):a.qid===d&&b.update(a.prop,a.value)},on_ui_event:function(a){for(var b=0;b<c.length;++b){var d=c[b];if(d.qid===a.qid){d.on_ui_event(a);break}}},set_exit:function(a){this.exit=a},toggle_remark:function(a){for(a=0;a<c.length;++a)c[a].toggle_remark();n&&n.toggle()}}},u=function(b,c){var d=c.device,f=a.div(b,"rs2_p_wrapper").height(d.height),l=a.div(f,"rs2_p_top"),m=a.div(f,
"rs2_p_header"),e=a.div(f,"rs2_p_section"),n=a.texts(m).addClass("rs2_p_title"),t=a.texts(m).addClass("rs2_p_hint"),q=a.div(f,"rs2_p_content"),z=a.div(f,"rs2_p_footer"),u=a.tag("<button>",z).text("\u4e0a\u4e00\u9875").on("click",function(){c.event({name:"prev"})}),w=a.tag("<button>",z).text("\u4e0b\u4e00\u9875").on("click",function(){c.event({name:"next"})}),A=z.is(":visible");return{show_nav:function(a){a.has_prev?u.show():u.hide();l.text("\u7b2c"+(a.index+1)+"\u9875/\u5171"+a.total+"\u9875")},show_page:function(b,
d){d=b.sections;e.empty();var g=!1;if(d&&0<d.length){g=!0;for(var l=0;l<d.length;++l)a.texts(e,d[l].title);e.show()}else e.hide();b.title||b.hint?(_has_header=!0,a.show_texts(n,b.title),a.show_texts(t,b.hint)):(n.hide(),t.hide());g?m.show():m.hide();c.platform==RS2_PLATFORM_CAWI?$(window).scrollTop(0):f.scrollTop(0);this.resize()},resize:function(){var a=d.height-l.height()-m.outerHeight()-e.outerHeight();A&&(a-=z.height());q.css({"min-height":a})},scroll_to_message:function(){var a=$(".rs2_q_error",
f),b=f;c.platform==RS2_PLATFORM_CAWI&&(b=$(window));if(0<a.length){a=a.first()[0].offsetTop;b.scrollTop();var d=b.height();b.scrollTop(a-.3*d)}},update:function(a,b){},update_exit:function(a){w.text(a?"\u63d0  \u4ea4":"\u4e0b\u4e00\u9875")},content:q}};return{create:function(b,c){var g,e=d(c);e.pcontent=function(){return g};var l=u(b,e);return{init:function(b,c){void 0===c&&(c={});var d=b.languages;d&&(E=d);(z=a.stylesheet("rs2_lang"))||(z=a.add_stylesheet("rs2_lang"));if(z)for(d=0;d<E.length;++d)a.set_css_rule(z,
".rs2_lang_"+d,"display:block");A=void 0;e.remark=f.create(b,c);e.view_mode=c.edit_type===RS2_I_EDIT_VIEW||c.edit_type===RS2_I_EDIT_PREVIEW;e.platform=c.platform},state:function(){var a={lang:""};a.remark_hidden=e.remark.hidden;a.has_remark=e.remark.has_remark;return a},create_page:function(a){return x(a,e)},show_nav:function(a){l.show_nav(a)},show_page:function(a,b){g&&g.remove();g=a;g.show(l,b)},show_messages:function(a){g&&(g.show_messages(a),l.resize(),l.scroll_to_message())},clear_messages:function(a){g&&
(g.clear_messages(a),l.resize())},reset_editing:function(a){g&&(g.clear_messages(a),l.resize(),g.set_exit(!1));l.update_exit(!1)},update_question:function(a){g.update(a,l)},update_survey:function(a){if(a)if(a.lang){A=a=a.lang;a:{for(var b=0;b<E.length;++b)if(E[b]===a){a="rs2_lang_"+b;break a}a=void 0}a=a?"."+a:void 0;b=z.cssRules||z.rules;for(var c=0;c<b.length;++c){var d=b[c];d.style.cssText=void 0===a||d.selectorText===a?"display : block":"display : none !important"}}else a.exit&&(g&&g.set_exit(a.exit),
l.update_exit(a.exit))},on_ui_event:function(a){g.on_ui_event(a)},toggle_remark:function(){g.toggle_remark()}}},add_ctrl:function(a,c){b[a]=c},update_order:function(a,b){"reverse"==a?b.reverse():"random"==a&&e.shuffle(b)},lang_res:function(a){w=a}}}(RS2_UI_WEB_REMARK,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_LABEL,{create:function(c,d){var b=a.texts(a.div(c,"rs2_ctrl_wrap"),d.qprop("body"));return{update_value:function(a,b){},update_content:function(c,d){a.show_texts(b,c)}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){e={create:function(c,d){var b=d.qprop("type");c=a.ctrl_form(c,"rs2_ctrl_text");var e=$("<input>").appendTo(c).blur(function(){var c=a.text_val($(this),b);d.event_edited(c,!1)}),f=d.qprop("right_label"),A=0;if(f){A+=40;var w=$("<span>").css({"margin-left":"5px"}).appendTo(c);a.show_inline_texts(w,f,void 0,void 0)}b===RS2_T_TEXT?e.attr("type","text"):1==d.qprop("calc")&&(A+=65,$("<button>").addClass("rs2_calc").text("\u8ba1\u7b97\u5668").appendTo(c).on("click",function(){console.log("calc");
d.plugin("calc",[],function(a,b){a&&(e.val(b),d.event_edited(b,!1))})}));0<A&&e.css("width","calc(100% - "+A+"px)");return{update_value:function(a,b){a=d.update_value(a);void 0!==a?e.val(a):!0!==b&&e.val("")},update_disabled:function(a,b){e.prop("disabled",!0===b)},clear:function(a){e.val("")},on_ui_event:function(a){}}}};f.add_ctrl(RS2_T_INTEGER,e);f.add_ctrl(RS2_T_FLOAT,e);f.add_ctrl(RS2_T_TEXT,e)})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_SELECT,{create:function(d,b){function e(){w=b.qprop("options");if("reverse"==t)w.reverse();else if("random"==t){var a=w,d=[],e=[],l;for(l=0;l<a.length;++l){var f=a[l];"fixed"==b.qprop(a[l],"order")?e.push(f):d.push(f)}0<d.length&&c.shuffle(d);w=d.concat(e)}for(a=0;a<w.length;++a)A(q,x,w[a])}function f(b,c,d){void 0!==u&&(d=a.option_elem(q,u),d.removeClass("rs2_ctrl_option_selected"),$(":text",d).prop("disabled",!0).val(""));if(b&&(d=a.option_elem(q,b),d.addClass("rs2_ctrl_option_selected"),
b=$("input",d),0<b.length))if(b.prop("disabled",!1),void 0!==c)b.val(c);else return b.val()}function A(c,d,e){c=a.div(c,"rs2_ctrl_option").attr({"rs2-data-option":e});a.set_option_cat(c,b.option_cat(e));a.checkbox(c,!0,b.qprop(e,"title"),function(){if(u===e)f(),b.event_edited(void 0,!1,e,!1),u=void 0,b.event_ui_edited(void 0,!1);else{var a=f(e),c={};b.embeded()&&void 0!=u&&(c[b.dataid(u)]=void 0);c[b.dataid(e)]="1";a&&(c[b.dataid(e,"input")]=a);u=e;b.event_edited(c,!1)}},b.qprop(e,"res"),b.qprop(e,
"res_type"));b.qprop(e,"has_input")&&a.tag("<input>",a.div(c)).attr({type:"text",disabled:!0}).blur(function(){var c={},d=a.text_val($(this));c[b.dataid(e)]="1";c[b.dataid(e,"input")]=d;b.event_edited(c,!0)});!1===b.qprop(e,"visible")&&c.hide()}var w=[],q=a.ctrl_form(d,"rs2_ctrl_select"),x=b.qid,u,t=b.qprop("order");e();return{update_value:function(a,c){if(a)for(var d=0;d<w.length;++d){var g=w[d];if("1"==a[b.dataid(g)]){var e=g;break}}if(e){var n;a&&(n=a[b.dataid(e,"input")]);f(e,n,!0);u=e}else e||
!1!==c||this.clear()},update_title:function(b,c){a.show_texts(a.option_elem(q,b,".rs2_text_wrap"),c)},update_disabled:function(b,c){a.disable_checkbox(a.option_checkbox(q),c);$("input",q).prop("disabled",c)},update_visible:function(b,c){b=a.option_elem(q,b);c?b.show():b.hide()},update_options:function(){q.empty();e()},update_option_category:function(b,c){a.select_options(q,c)},clear:function(){f();u=void 0},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_SELECT_H,{create:function(d,b){function e(){w=b.qprop("options");if("reverse"==n)w.reverse();else if("random"==n){var a=w,d=[],l=[],e;for(e=0;e<a.length;++e){var f=a[e];"fixed"==b.qprop(a[e],"order")?l.push(f):d.push(f)}0<d.length&&c.shuffle(d);w=d.concat(l)}for(a=0;a<w.length;++a)A(q,x,w[a])}function f(b,c,d){void 0!==u&&(d=a.option_elem(q,u),d.removeClass("rs2_ctrl_option_selected"),$(":text",d).prop("disabled",!0));if(b&&(d=a.option_elem(q,b),d.addClass("rs2_ctrl_option_selected"),
b=$("input",d),0<b.length))if(b.prop("disabled",!1),void 0!==c)b.val(c);else return b.val()}function A(c,d,e){c=$("<div>").addClass("rs2_ctrl_option").appendTo(c).attr({"rs2-data-option":e});t&&c.css({width:t});a.set_option_cat(c,b.option_cat(e));a.checkbox(c,!0,b.qprop(e,"title"),function(){if(u===e)f(),b.event_edited(void 0,!1,e,!1),u=void 0,b.event_ui_edited(void 0,!1);else{var a=f(e),c={};b.embeded()&&void 0!=u&&(c[b.dataid(u)]=void 0);c[b.dataid(e)]="1";a&&(c[b.dataid(e,"input")]=a);u=e;b.event_edited(c,
!1)}},b.qprop(e,"res"),b.qprop(e,"res_type"));!1===b.qprop(e,"visible")&&c.hide()}var w=[],q=$("<div>").appendTo(a.ctrl_form(d,"rs2_ctrl_select")).css({display:"flex","flex-direction":"row","flex-wrap":"wrap"}),x=b.qid,u,t;d=b.qprop("col");0<d&&(t=100/d+"%");var n=b.qprop("order");e();return{update_value:function(a,c){if(a)for(var d=0;d<w.length;++d){var g=w[d];if("1"==a[b.dataid(g)]){var e=g;break}}if(e){var n;a&&(n=a[b.dataid(e,"input")]);f(e,n,!0);u=e}else e||!1!==c||this.clear()},update_title:function(b,
c){a.show_texts(a.option_elem(q,b,".rs2_text_wrap"),c)},update_disabled:function(b,c){a.disable_checkbox(a.option_checkbox(q),c);$("input",q).prop("disabled",c)},update_visible:function(b,c){b=a.option_elem(q,b);c?b.show():b.hide()},update_options:function(){q.empty();e()},update_option_category:function(b,c){a.select_options(q,c)},clear:function(){f();u=void 0},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_MULSELECT,{create:function(d,b){function e(){w=b.qprop("options");if("reverse"==t)w.reverse();else{var a;if(a="random"==t)a:if(void 0===w||0===w.length)a=!1;else{a=b.qprop(w[0],"group");for(var d=1;d<w.length;++d)if(b.qprop(w[d],"group")!=a){a=!1;break a}a=!0}if(a){a=w;d=[];var e=[],l;for(l=0;l<a.length;++l){var f=a[l];"fixed"==b.qprop(a[l],"order")?e.push(f):d.push(f)}0<d.length&&c.shuffle(d);w=d.concat(e)}}for(a=0;a<w.length;++a){d=w[a];e=b.qprop(d,"group");l=
q;if(void 0!=e){if(void 0==z||e!==z){var u=$("<div>").addClass("rs2_ctrl_option_group").appendTo(q);var z=e}l=u}A(l,x,d,e)}}function f(b){void 0!==b?(b=$(".rs2_ctrl_option[rs2-data-group!='"+b+"'] ",q),$("input",b).prop("disabled",!0),a.disable_checkbox(a.option_checkbox(b),!0)):(b=$(".rs2_ctrl_option",q),b.attr("disabled",!1),a.disable_checkbox(a.option_checkbox(b),!1))}function A(c,d,e,l){var g=a.div(c,"rs2_ctrl_option").attr({"rs2-data-option":e,"rs2-data-group":l});a.set_option_cat(g,b.option_cat(e));
var n;a.checkbox(g,!1,b.qprop(e,"title"),function(){$(this);var a=n,c={};g.toggleClass("rs2_ctrl_option_selected");var d=g.hasClass("rs2_ctrl_option_selected");c[b.dataid(e)]=d?"1":"0";a&&(a.attr("disabled",!d),d?c[b.dataid(e,"input")]=a.val():a.val(""));u+=d?1:-1;void 0!==l&&(1===u?f(l):0===u&&f());b.event_edited(c,!0)},b.qprop(e,"res"),b.qprop(e,"res_type"));b.qprop(e,"has_input")&&(n=$("<input>").attr({type:"text",disabled:!0}).addClass("rs2_ctrl_text").appendTo($("<div>").appendTo(g)).blur(function(){var c=
$(this),d={};c=a.text_val(c);d[b.dataid(e)]="1";d[b.dataid(e,"input")]=c;b.event_edited(d,!0)}));!1===b.qprop(e,"visible")&&g.hide()}var w=[],q=a.ctrl_form(d),x=b.qid,u=0,t=b.qprop("order");e();return{update_value:function(c,d){c=c||{};d||(u=0);for(var g=0;g<w.length;++g){var e=w[g],m=b.dataid(e),n=c[m];b.tagid(e);var t=a.option_elem(q,e);if(n)if(n="1"==n,u+=n?1:0,m=c[m+".input"]||"",$(":text",t).val(m).attr("disabled",!n),n){t.addClass("rs2_ctrl_option_selected");var G=b.qprop(e,"group")}else t.removeClass("rs2_ctrl_option_selected");
else d||(t.removeClass("rs2_ctrl_option_selected"),$(":text",t).val("").attr("disabled",!0))}0===u?f():G&&f(G)},update_title:function(b,c){a.show_texts(a.option_elem(q,b,".rs2_text_wrap"),c)},update_disabled:function(a,b){$("input",q).prop("disabled",b);b?$(".rs2_ctrl_checkbox",q).addClass("rs2_ctrl_disabled"):$(".rs2_ctrl_checkbox",q).removeClass("rs2_ctrl_disabled")},update_visible:function(b,c){b=a.option_elem(q,b);c?b.show():b.hide()},update_option_category:function(b,c){a.select_options(q,c)},
update_options:function(){q.empty();e()},clear:function(){u=0;$(".rs2_ctrl_option_selected",q).removeClass("rs2_ctrl_option_selected");f()},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_MULSELECT_H,{create:function(d,b){function e(){w=b.qprop("options");if("reverse"==n)w.reverse();else{var a;if(a="random"==n)a:if(void 0===w||0===w.length)a=!1;else{a=b.qprop(w[0],"group");for(var d=1;d<w.length;++d)if(b.qprop(w[d],"group")!=a){a=!1;break a}a=!0}if(a){a=w;d=[];var e=[],f;for(f=0;f<a.length;++f){var t=a[f];"fixed"==b.qprop(a[f],"order")?e.push(t):d.push(t)}0<d.length&&c.shuffle(d);w=d.concat(e)}}for(a=0;a<w.length;++a){d=w[a];e=b.qprop(d,"group");
f=q;if(void 0!=e){if(void 0==G||e!==G){var u=$("<div>").addClass("rs2_ctrl_option_group").appendTo(q);var G=e}f=u}f.css({display:"flex","flex-direction":"row","flex-wrap":"wrap"});A(f,x,d,e)}}function f(b){void 0!==b?(b=$(".rs2_ctrl_option[rs2-data-group!='"+b+"'] ",q),$("input",b).prop("disabled",!0),a.disable_checkbox(a.option_checkbox(b),!0)):(b=$(".rs2_ctrl_option",q),b.attr("disabled",!1),a.disable_checkbox(a.option_checkbox(b),!1))}function A(c,d,e,m){var g=a.div(c,"rs2_ctrl_option").attr({"rs2-data-option":e,
"rs2-data-group":m});t&&g.css({width:t});a.set_option_cat(g,b.option_cat(e));var l;a.checkbox(g,!1,b.qprop(e,"title"),function(){$(this);var a=l,c={};g.toggleClass("rs2_ctrl_option_selected");var d=g.hasClass("rs2_ctrl_option_selected");c[b.dataid(e)]=d?"1":"0";a&&(a.attr("disabled",!d),d?c[b.dataid(e,"input")]=a.val():a.val(""));u+=d?1:-1;void 0!==m&&(1===u?f(m):0===u&&f());b.event_edited(c,!0)},b.qprop(e,"res"),b.qprop(e,"res_type"));b.qprop(e,"has_input")&&(l=$("<input>").attr({type:"text",disabled:!0}).addClass("rs2_ctrl_text").appendTo($("<div>").appendTo(g)).blur(function(){var c=
$(this),d={};c=a.text_val(c);d[b.dataid(e)]="1";d[b.dataid(e,"input")]=c;b.event_edited(d,!0)}));!1===b.qprop(e,"visible")&&g.hide()}var w=[],q=a.ctrl_form(d),x=b.qid,u=0,t;d=b.qprop("col");0<d&&(t=100/d+"%");var n=b.qprop("order");e();return{update_value:function(c,d){c=c||{};d||(u=0);for(var e=0;e<w.length;++e){var g=w[e],n=b.dataid(g),t=c[n];b.tagid(g);var y=a.option_elem(q,g);if(t)if(t="1"==t,u+=t?1:0,n=c[n+".input"]||"",$(":text",y).val(n).attr("disabled",!t),t){y.addClass("rs2_ctrl_option_selected");
var z=b.qprop(g,"group")}else y.removeClass("rs2_ctrl_option_selected");else d||(y.removeClass("rs2_ctrl_option_selected"),$(":text",y).val("").attr("disabled",!0))}0===u?f():z&&f(z)},update_title:function(b,c){a.show_texts(a.option_elem(q,b,".rs2_text_wrap"),c)},update_disabled:function(a,b){$("input",q).prop("disabled",b);b?$(".rs2_ctrl_checkbox",q).addClass("rs2_ctrl_disabled"):$(".rs2_ctrl_checkbox",q).removeClass("rs2_ctrl_disabled")},update_visible:function(b,c){b=a.option_elem(q,b);c?b.show():
b.hide()},update_option_category:function(b,c){a.select_options(q,c)},update_options:function(){q.empty();e()},clear:function(){u=0;$(".rs2_ctrl_option_selected",q).removeClass("rs2_ctrl_option_selected");f()},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_MATRIX,{create:function(d,b){function e(d,e,g){d=a.tag("<tr>",d).attr("rs2-data-row",g);var f=b.qprop(c.key(g,void 0),"title")||[];n[g]=a.texts(a.tag("<td>",d,"rs2_matrix_row_title"),f).get(0);for(f=0;f<e.length;++f){var l=$("<td>").appendTo(d),m=e[f],t=b.qprop(c.key(void 0,m),"type");t===RS2_T_SELECT&&"horizental"==b.qprop(c.key(void 0,m),"layout")&&(t=RS2_T_SELECT_H);var u=c.key(g,m);l=b.create_ctrl(l,t,b.extend(void 0,m,g));w[u]=l}0==b.qprop(g,"visible")&&d.hide()}
function E(a){a=a.split(".");var b={};if(0<a.length)if(1===a.length){var c=a[0];0<=t.indexOf(c)?b.rid=c:b.cid=c}else c=a[0],0<=u.indexOf(c)?(b.cid=c,b.option=a[1]):(b.rid=c,b.cid=a[1]);return b}function A(a,b,d){if(a&&a.cid&&a.option)for(var e=0;e<t.length;++e){var g=w[c.key(t[e],a.cid)];g&&(g=g[b])&&g(a.option,d)}else for(e in w)(g=w[e][b])&&g(void 0,d)}var w={};d=a.ctrl_form(d,"rs2_matrix");var q=a.tag("<table>",d),x=b.qprop("style");"border"==x?q.addClass("rs2_matrix_border"):"excel"==x&&q.addClass("rs2_matrix_border rs2_matrix_excel");
var u=b.question.cols,t=b.question.rows,n={},g={};f.update_order(b.qprop("order"),t);(function(d,e){d=a.tag("<tr>",a.tag("<thead>",d));a.tag("<td>",d);for(var f=0;f<e.length;++f){var l=e[f],m=b.qprop(c.key(l,void 0),"title")||[];g[l]=a.texts(a.tag("<td>",d,"rs2_matrix_col_title"),m).get(0)}})(q,u);x=$("<tbody>").appendTo(q);for(var y=0;y<t.length;++y)e(x,u,t[y]);!0===b.qprop("hscroll")?d.addClass("rs2_table_hscroll"):(d.addClass("rs2_table_fixed_wrap"),$("td",q).css("width",100/(u.length+1)+"%"));
return{update_value:function(a,b){for(var c in w)w[c].update_value(a,b)},update_title:function(b,c){b=E(b);b.option?A(b,"update_title",c):b.rid?(b=n[b.rid])&&a.show_texts($(b),c):b.cid&&(b=g[b.cid])&&a.show_texts($(b),c)},update_disabled:function(a,b){void 0===a?A(void 0,"update_disabled",b):A(E(a),"update_disabled",b)},update_visible:function(a,b){a=E(a);a.option?A(a,"update_visible",b):a.rid&&(a=$("tr[rs2-data-row="+a.rid+"]",q),b?a.show():a.hide())},clear:function(){for(var a in cells)cells[a].clear()},
on_ui_event:function(a){if(a.vprefix){var b=w[a.vprefix];if(b)b.on_ui_event(a)}}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_MATRIX_SELECT,{create:function(c,b){function d(c,d,e){var g=a.checkbox(c,!0,!1,function(){var a=g,c=n[d],f={},l=b.dataid(d+"."+m,e);c===e?(a.removeClass("rs2_ctrl_option_selected"),c=f[l]=void 0,a={},a[l]="0",b.event_ui_edited(a,!0)):(void 0!==c&&$("div[rs2-data-option='"+c+"']",a.parent().parent()).removeClass("rs2_ctrl_option_selected"),a.addClass("rs2_ctrl_option_selected"),c&&(f[b.dataid(d+"."+m,c)]=void 0),f[l]="1",c=e);n[d]=c;b.event_edited(f,!0,void 0,void 0!==
c)}).attr("rs2-data-option",e)}function e(c,d,e,g){var f=a.checkbox(c,!1,!1,function(){var l=c.parent(),t=f,u={};t.toggleClass("rs2_ctrl_option_selected");t=t.hasClass("rs2_ctrl_option_selected");var q=n[d]||0;g&&(0==q&&t?a.disable_checkbox($("div[rs2-data-group!='"+g+"']",l),!0):1!=q||t||a.disable_checkbox(a.option_checkbox(l),!1));n[d]=t?q+1:q-1;u[b.dataid(d+"."+m,e)]=t?"1":"0";b.event_edited(u,!0)}).attr("rs2-data-option",e);g&&f.attr("rs2-data-group",g)}function A(a){var b=a.split(".");a={};0<
b.length&&(b[0]===m?a.option=b[1]:(b=b[0],0<=u.indexOf(b)?a.rid=b:a.option=b));return a}c=a.ctrl_form(c,"rs2_matrix_select");var w=a.tag("<table>",c).css("min-width","99%"),q=b.question,x=q.cols,u=q.rows,t=[],n={},g=!0,y=[],l=[];f.update_order(b.qprop("order"),u);if(x&&0<x.length){var m=x[0];t=b.qprop(m,"options");g=b.qprop(m,"type")===RS2_T_SELECT}x=a.tag("<tr>",a.tag("<thead>",w));$("<td>").appendTo(x);for(var D=0;D<t.length;++D)q=t[D],q=b.qprop(m+"."+q,"title")||[],y.push(a.texts(a.tag("<td>",
x,"rs2_matrix_col_title"),q));x=$("<tbody>").appendTo(w);for(D=0;D<u.length;++D){var F=u[D],G=a.tag("<tr>",x).attr("rs2-data-row",F);q=b.qprop(F,"title")||[];l.push(a.texts(a.tag("<td>",G,"rs2_matrix_row_title"),q));for(var H=0;H<t.length;++H){q=t[H];var I=$("<td>").appendTo(G);g?d(I,F,q):e(I,F,q,b.qprop(m+"."+q,"group"))}0==b.qprop(F,"visible")&&G.hide()}!0===b.qprop("hscroll")?c.addClass("rs2_table_hscroll_select"):(c.addClass("rs2_table_fixed_wrap"),$("td",w).css("width",100/(y.length+1)+"%"));
return{update_value:function(c,d){if(c)if(g)for(var e=w.get(0),f=0;f<u.length;++f){var l=u[f],q=void 0,y;if(c)for(var z=0;z<t.length;++z){var A=t[z];if(y=c[b.dataid(l+"."+m,A)]){q=A;break}}if(q||!0!==d)z=$(e.rows[f+1]),a.option_checkbox(z).removeClass("rs2_ctrl_option_selected"),"1"==y&&$("div[rs2-data-option='"+q+"']",z).addClass("rs2_ctrl_option_selected"),n[l]=q}else for(y=w.get(0),f=0;f<u.length;++f){l=u[f];q=$(y.rows[f+1]);for(z=0;z<t.length;++z){A=t[z];var G=$("div[rs2-data-option='"+A+"']",
q),x=c[b.dataid(l+"."+m,A)];x?((x="1"==x)&&void 0==e&&(e=b.qprop(m+"."+A,"group")),x?G.addClass("rs2_ctrl_option_selected"):G.removeClass("rs2_ctrl_option_selected")):!0!==d&&G.removeClass("rs2_ctrl_option_selected")}z=$(".rs2_ctrl_option_selected",q).length;0===z?a.disable_checkbox(a.option_checkbox(q),!1):void 0!=e&&a.disable_checkbox($("div[rs2-data-group!='"+e+"']",q),!0);n[l]=z}else!0!==d&&this.clear()},update_title:function(b,c){b=A(b);b.rid?(b=u.indexOf(b.rid),0<=b&&a.show_texts(l[b],c)):b.option&&
(b=t.indexOf(b.option),0<=b&&a.show_texts(y[b],c))},update_disabled:function(a,b){},update_visible:function(b,c){b=A(b);var d=w.get(0);if(b.rid){var e=u.indexOf(b.rid);0<=e&&a.update_visible($(d.rows[e+1]),c)}else if(b.option&&(e=t.indexOf(b.option),0<=e))for(b=0;b<u.length+1;++b)a.update_visible($(d.rows[b].cells[e+1]),c)},clear:function(){a.option_checkbox(w).removeClass("rs2_ctrl_option_selected");n={}},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_MATRIX_SELECT_COMPACT,{create:function(c,b){function d(c){c=a.tag("<tr>",c,"rs2_matrix_col_title");for(var d=0;d<t.length;++d){var e=t[d],g=b.qprop(l+"."+e,"title")||[];a.texts(a.tag("<td>",c),g).attr("rs2-data-option",e)}}function e(c,d,e){var g=a.checkbox(c,!0,!1,function(){var a=g,c=n[d],f={},m=b.dataid(d+"."+l,e);c===e?(a.removeClass("rs2_ctrl_option_selected"),c=f[m]=void 0,b.event_edited(f,!0,void 0,!1),a={},a[m]="0",b.event_ui_edited(a,!0)):(void 0!==c&&
$("div[rs2-data-option='"+c+"']",a.parent().parent()).removeClass("rs2_ctrl_option_selected"),a.addClass("rs2_ctrl_option_selected"),c&&(f[b.dataid(d+"."+l,c)]=void 0),f[m]="1",c=e,b.event_edited(f,!0));n[d]=c}).attr("rs2-data-option",e)}function A(c,d,e,g){var f=a.checkbox(c,!1,!1,function(){var m=c.parent(),t=f,q={};t.toggleClass("rs2_ctrl_option_selected");t=t.hasClass("rs2_ctrl_option_selected");var u=n[d]||0;g&&(0==u&&t?a.disable_checkbox($("div[rs2-data-group!='"+g+"']",m),!0):1!=u||t||a.disable_checkbox(a.option_checkbox(m),
!1));n[d]=t?u+1:u-1;q[b.dataid(d+"."+l,e)]=t?"1":"0";b.event_edited(q,!0)}).attr("rs2-data-option",e);g&&f.attr("rs2-data-group",g)}function w(a){var b=a.split(".");a={};0<b.length&&(b[0]===l?a.option=b[1]:(b=b[0],0<=u.indexOf(b)?a.rid=b:a.option=b));return a}var q=a.tag("<table>",a.ctrl_form(c,"rs2_matrix_select rs2_table_wrap")).attr({border:"0",cellpadding:"0",cellspacing:"0"});c=b.question;var x=c.cols,u=c.rows,t=[],n={},g=!0,y=[];f.update_order(b.qprop("order"),u);if(x&&0<x.length){var l=x[0];
t=b.qprop(l,"options");g=b.qprop(l,"type")===RS2_T_SELECT}c=$("<tbody>").appendTo(q);for(x=0;x<u.length;++x){0==x%3&&d(c);var m=u[x],D=a.tag("<td>",a.tag("<tr>",c),"rs2_matrix_row_title").attr({colspan:t.length}),F=b.qprop(m,"title")||[];y.push(a.texts(D,F));D=a.tag("<tr>",c,"rs2_matrix_select_row").attr("rs2-data-row",m);for(F=0;F<t.length;++F){var G=t[F],H=$("<td>").appendTo(D);g?e(H,m,G):A(H,m,G,b.qprop(l+"."+G,"group"))}0==b.qprop(m,"visible")&&D.hide()}return{on_showed:function(){var a=q.parent();
20>q.width()-a.width()&&a.css({"overflow-x":"hidden"})},update_value:function(c,d){if(c)if(g)for(var e=0;e<u.length;++e){var f=u[e],m=void 0,y;if(c)for(var z=0;z<t.length;++z){var w=t[z];if(y=c[b.dataid(f+"."+l,w)]){m=w;break}}if(m||!0!==d)z=$("tr[rs2-data-row='"+f+"']",q),a.option_checkbox(z).removeClass("rs2_ctrl_option_selected"),"1"==y&&$("div[rs2-data-option='"+m+"']",z).addClass("rs2_ctrl_option_selected"),n[f]=m}else for(y=0;y<u.length;++y){f=u[y];m=$("tr[rs2-data-row='"+f+"']",q);for(z=0;z<
t.length;++z){w=t[z];var A=c[b.dataid(f+"."+l,w)],G="1"==A;G&&void 0==e&&(e=b.qprop(l+"."+w,"group"));var x=$("div[rs2-data-option='"+w+"']",m);G?(console.log("option "+w+" div "+x.length),x.addClass("rs2_ctrl_option_selected")):"0"!=A&&!0===d||x.removeClass("rs2_ctrl_option_selected")}z=$(".rs2_ctrl_option_selected",m).length;0===z?a.disable_checkbox(a.option_checkbox(m),!1):void 0!=e&&a.disable_checkbox($("div[rs2-data-group!='"+e+"']",m),!0);n[f]=z}else!0!==d&&this.clear()},update_title:function(b,
c){b=w(b);b.rid?(b=u.indexOf(b.rid),0<=b&&a.show_texts(y[b],c)):b.option&&$(".rs2_text_wrap[rs2-data-option='"+b.option+"']",q).each(function(){a.show_texts($(this),c)})},update_disabled:function(a,b){b?$(".rs2_ctrl_checkbox",q).addClass("rs2_ctrl_disabled"):$(".rs2_ctrl_checkbox",q).removeClass("rs2_ctrl_disabled")},update_visible:function(b,c){b=w(b);var d=q.get(0);if(b.rid){var e=u.indexOf(b.rid);0<=e&&a.update_visible($(d.rows[e+1]),c)}else if(b.option&&(e=t.indexOf(b.option),0<=e))for(b=0;b<
u.length+1;++b)a.update_visible($(d.rows[b].cells[e+1]),c)},clear:function(){a.option_checkbox(q).removeClass("rs2_ctrl_option_selected");n={}},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_MATRIX_FIXEDCOL,{create:function(d,b){function e(d,e,g){d=a.tag("<tr>",d).attr("rs2-data-row",g);var f=b.qprop(c.key(g,void 0),"title")||[];l[g]=a.texts(a.tag("<td>",a.tag("<tr>",x).attr("rs2-data-row",g),"rs2_matrix_row_title"),f);for(f=0;f<e.length;++f){var m=$("<td>").appendTo(d),n=e[f],t=b.qprop(c.key(void 0,n),"type"),q=c.key(g,n);m=b.create_ctrl(m,t,b.extend(void 0,n,g));w[q]=m}0==b.qprop(g,"visible")&&d.hide()}function E(a){a=a.split(".");var b={};if(0<a.length)if(1===
a.length){var c=a[0];0<=y.indexOf(c)?b.rid=c:b.cid=c}else c=a[0],0<=g.indexOf(c)?(b.cid=c,b.option=a[1]):(b.rid=c,b.cid=a[1]);return b}function A(a,b,d){if(a.cid&&a.option)for(var e=0;e<y.length;++e){var g=w[c.key(y[e],a.cid)];g&&(g=g[b])&&g(a.option,d)}}var w={},q=a.tag("<tr>",a.tag("<table>",d).attr({cellspacing:0}).css({width:"100%",padding:0})),x=a.tag("<table>",a.tag("<td>",q).css({padding:0})).attr("border","0"),u=a.div(a.tag("<td>",q).css({padding:0})).css({"overflow-x":"scroll"}),t=a.tag("<table>",
a.ctrl_form(u,"rs2_matrix")),n=b.qprop("style");"border"==n?(x.addClass("rs2_matrix_border_fixed_col"),t.addClass("rs2_matrix_border")):"excel"==n&&(x.addClass("rs2_matrix_border_fixed_col rs2_matrix_excel"),t.addClass("rs2_matrix_border rs2_matrix_excel"));var g=b.question.cols,y=b.question.rows,l={},m={};f.update_order(b.qprop("order"),y);(function(d,e){d=a.tag("<tr>",a.tag("<thead>",d));for(var g=0;g<e.length;++g){var f=e[g],l=b.qprop(c.key(f,void 0),"title")||[];m[f]=a.texts(a.tag("<td>",d,"rs2_matrix_col_title"),
l).get(0)}})(t,g);a.tag("<td>",a.tag("<tr>",x));n=$("<tbody>").appendTo(t);for(var D=0;D<y.length;++D)e(n,g,y[D]);a.tag("<td>",a.tag("<tr>",x,"rs2_cell_empty"));return{update_value:function(a,b){for(var c in w)w[c].update_value(a,b)},on_showed:function(){a.align_table(x,t);x.height(u.height());u.width(d.width()-x.width())},update_title:function(b,c){b=E(b);if(b.option)A(b,"update_title",c);else if(b.rid){if(b=l[b.rid])a.show_texts($(b),c),a.align_table(x,t)}else b.cid&&(b=m[b.cid])&&a.show_texts($(b),
c)},update_disabled:function(a,b){A(E(a),"update_disabled",b)},update_visible:function(a,b){a=E(a);a.option?A(a,"update_visible",b):a.rid&&(a=$("tr[rs2-data-row="+a.rid+"]",q),b?a.show():a.hide())},clear:function(){for(var a in cells)cells[a].clear()},on_ui_event:function(a){if(a.vprefix){var b=w[a.vprefix];if(b)b.on_ui_event(a)}}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_MATRIX_SELECT_FIXEDCOL,{create:function(c,b){function d(b){G.push(a.texts(a.tag("<td>",a.tag("<tr>",x),"rs2_matrix_row_title"),b))}function e(c,d,e){var g=a.checkbox(c,!0,!1,function(){var a=g,c=m[d],f={};if(c===e){a.removeClass("rs2_ctrl_option_selected");a=b.dataid(d+"."+H,c);c=f[a]=void 0;var l={};l[a]="0";b.event_ui_edited(l,!0)}else void 0!==c&&$("div[rs2-data-option='"+c+"']",a.parent().parent()).removeClass("rs2_ctrl_option_selected"),a.addClass("rs2_ctrl_option_selected"),
c&&(f[b.dataid(d+"."+H,c)]=void 0),f[b.dataid(d+"."+H,e)]="1",c=e;m[d]=c;b.event_edited(f,!0,void 0,void 0!==c)}).attr("rs2-data-option",e)}function A(c,d,e,g){var f=a.checkbox(c,!1,!1,function(){var l=c.parent(),n=f,t={};n.toggleClass("rs2_ctrl_option_selected");n=n.hasClass("rs2_ctrl_option_selected");var q=m[d]||0;g&&(0==q&&n?a.disable_checkbox($("div[rs2-data-group!='"+g+"']",l),!0):1!=q||n||a.disable_checkbox(a.option_checkbox(l),!1));m[d]=n?q+1:q-1;t[b.dataid(d+"."+H,e)]=n?"1":"0";b.event_edited(t,
!0)}).attr("rs2-data-option",e);g&&f.attr("rs2-data-group",g)}function w(a){var b=a.split(".");a={};0<b.length&&(b[0]===H?a.option=b[1]:(b=b[0],0<=y.indexOf(b)?a.rid=b:a.option=b));return a}var q=a.tag("<tr>",a.tag("<table>",c).attr({cellspacing:0}).css({width:"100%",padding:0})),x=a.tag("<table>",a.tag("<td>",q).css({padding:0})),u=a.div(a.tag("<td>",q).css({padding:0})).css({"overflow-x":"scroll"}),t=a.tag("<table>",a.ctrl_form(u,"rs2_matrix_select"));"border"==b.qprop("style")&&(x.addClass("rs2_matrix_border_fixed_col"),
t.addClass("rs2_matrix_border"));var n=b.question,g=n.cols,y=n.rows,l=[],m={},D=!0,F=[],G=[];f.update_order(b.qprop("order"),y);if(g&&0<g.length){var H=g[0];l=b.qprop(H,"options");D=b.qprop(H,"type")===RS2_T_SELECT}g=a.tag("<tr>",a.tag("<thead>",t));for(var I=0;I<l.length;++I)n=l[I],n=b.qprop(H+"."+n,"title")||[],F.push(a.texts(a.tag("<td>",g,"rs2_matrix_col_title"),n));g=$("<tbody>").appendTo(t);a.tag("<td>",a.tag("<tr>",x));for(I=0;I<y.length;++I){var J=y[I];d(b.qprop(J,"title")||[]);for(var K=
a.tag("<tr>",g).attr("rs2-data-row",J),B=0;B<l.length;++B){n=l[B];var C=$("<td>").appendTo(K).height(44);D?e(C,J,n):A(C,J,n,b.qprop(H+"."+n,"group"))}0==b.qprop(J,"visible")&&K.hide()}a.tag("<td>",a.tag("<tr>",x,"rs2_cell_empty"));return{update_value:function(c,d){if(c)if(D)for(var e=t.get(0),g=0;g<y.length;++g){var f=y[g],n=void 0,q;if(c)for(var u=0;u<l.length;++u){var z=l[u];if(q=c[b.dataid(f+"."+H,z)]){n=z;break}}if(n||!0!==d)u=$(e.rows[g+1]),a.option_checkbox(u).removeClass("rs2_ctrl_option_selected"),
"1"==q&&$("div[rs2-data-option='"+n+"']",u).addClass("rs2_ctrl_option_selected"),m[f]=n}else for(q=t.get(0),g=0;g<y.length;++g){f=y[g];n=$(q.rows[g+1]);for(u=0;u<l.length;++u){z=l[u];var w=$("div[rs2-data-option='"+z+"']",n),A=c[b.dataid(f+"."+H,z)];A?((A="1"==A)&&void 0==e&&(e=b.qprop(H+"."+z,"group")),A?w.addClass("rs2_ctrl_option_selected"):w.removeClass("rs2_ctrl_option_selected")):!0!==d&&w.removeClass("rs2_ctrl_option_selected")}u=$(".rs2_ctrl_option_selected",n).length;0===u?a.disable_checkbox(a.option_checkbox(n),
!1):void 0!=e&&a.disable_checkbox($("div[rs2-data-group!='"+e+"']",n),!0);m[f]=u}else!0!==d&&this.clear()},on_showed:function(){a.align_table(x,t);x.height(u.height());u.width(c.width()-x.width())},update_title:function(b,c){b=w(b);b.rid?(b=y.indexOf(b.rid),0<=b&&(a.show_texts(G[b],c),a.align_table(x,t))):b.option&&(b=l.indexOf(b.option),0<=b&&a.show_texts(F[b],c))},update_disabled:function(a,b){b?$(".rs2_ctrl_checkbox",q).addClass("rs2_ctrl_disabled"):$(".rs2_ctrl_checkbox",q).removeClass("rs2_ctrl_disabled")},
update_visible:function(b,c){b=w(b);var d=t.get(0),e=x.get(0);if(b.rid){var g=y.indexOf(b.rid);0<=g&&(a.update_visible($(d.rows[g+1]),c),a.update_visible($(e.rows[g+1]),c))}else if(b.option&&(g=l.indexOf(b.option),0<=g))for(b=0;b<y.length+1;++b)a.update_visible($(d.rows[b].cells[g+1]),c)},clear:function(){a.option_checkbox(q).removeClass("rs2_ctrl_option_selected");m={}},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_ASSIGNMENT,{create:function(c,b){function d(){q=b.qprop("options");for(var a=0;a<q.length;++a)w(q[a])}function e(c,d,e){var g={};g[b.dataid(d)]=a.text_val(c,e);b.event_edited(g,!0)}function f(a){a=b.qprop(a,"type");return"integer"===a?RS2_T_INTEGER:"float"===a?RS2_T_FLOAT:RS2_T_TEXT}function w(c){var d=u.create(c);a.texts($("<td>").appendTo(d),b.qprop(c,"title"));var g=f(c),q=$("<input>").addClass("rs2_ctrl_text").appendTo($("<td>").appendTo(d)).blur(function(){e(q,
c,g)});g===RS2_T_TEXT&&q.attr("type","text");var l=$("<td>").appendTo(d);a.texts(l,b.qprop(c,"right_label"));!1===b.qprop(c,"visible")&&d.hide();if(1==b.qprop(c,"calc"))$("<button>").addClass("rs2_calc").text("\u8ba1\u7b97\u5668").appendTo($("<td>").appendTo(d)).on("click",function(){b.plugin("calc",[],function(a,b){a&&(q.val(b),e(q,c,g))})});else l.attr("colspan","2")}var q=[],x=a.tag("<table>",a.ctrl_form(c,"rs2_q_assignment")),u=a.option_builder(x,"tr");d();return{update_value:function(a,c){u.each(function(d,
e){d=$("input",d);var g;a&&(g=a[b.dataid(e)]);!g&&c||d.val(g||"")})},update_title:function(b,c){a.show_texts(u.elem(b,".rs2_text_wrap"),c)},update_disabled:function(a,b){$("input",x).prop("disabled",b)},update_visible:function(a,b){a=u.elem(a);b?a.show():a.hide()},update_options:function(){x.empty();d()},clear:function(){$("input",x).val("")},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e){function c(a){return a?e.replaceAll(a,"\\\\\\\\n","\n"):a}f.add_ctrl(RS2_T_TEXTAREA,{create:function(d,b){var f=$("<textarea>").addClass("rs2_ctrl_text").appendTo(a.ctrl_form(d)).blur(function(){var c=(c=a.text_val($(this)))?e.replaceAll(c,"\n","\\\\n"):c;b.event_ui(RS2_M_UI_INPUT,void 0,c);b.event_edited(c,!1)});return{update_value:function(a,d){f.val(c(b.update_value(a)||""))},update_disabled:function(a,b){f.prop("disabled",!0===b)},clear:function(a){f.val("")},on_ui_event:function(a){f.val(a.value)}}}})})(RS2_UI_WEB_VIEW,
RS2_UI_HTML,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_SORT,{create:function(d,b){function f(){for(var a=q.sortable("toArray",{attribute:"rs2-data-option"}),c={},d=0;d<a.length;++d)c[b.dataid(a[d])]=""+d;b.event_edited(c,!1)}function E(a){if(void 0!==y&&g>=y)alert("\u6700\u591a\u53ea\u80fd\u9009\u62e9"+y+"\u9879");else{++g;var c=a.attr("rs2-data-option");a.hide();var d=e.tag("<li>",q).attr("rs2-data-option",c);e.texts(d,b.qprop(c,"title"));$("<span>").text("\u2716").addClass("rs2_ctrl_sort_delete").on("click",function(){d.remove();
--g;var b=x.children("li[rs2-data-option='"+c+"']");0<b.length&&!0!==b.prop("disabled")&&a.show();f()}).appendTo(d)}}function A(a,b){b?a.show().prop("disabled",!1):a.hide().prop("disabled",!0)}function w(){for(var a=b.qprop("options"),c=0;c<a.length;++c){var d=a[c],g=t.create(d).on("click",function(){n||(E($(this)),f())});e.texts(g,b.qprop(d,"title"));0==b.qprop(d,"visible")&&A(g,!1)}}d=e.div(d,"rs2_ctrl_wrap rs2_ctrl_sort");var q=e.tag("<ul>",d,"rs2_ctrl_sorted").sortable({stop:function(a,b){f()}}).disableSelection();
e.div(d,"rs2_ctrl_note").text("\u6309\u6392\u5217\u987a\u5e8f\u70b9\u51fb\u4e0b\u5217\u9879\u6dfb\u52a0\u5230\u6b64\u5904");var x=e.tag("<ul>",d,"rs2_ctrl_sort_elem"),u=[],t=e.option_builder(x,"li"),n=!1,g=0,y=b.qprop("max");w();return{update_value:function(b,d){this.clear();g=0;if(b)for(d=0;d<u.length;++d){var e=c.keyForValue(b,d);void 0!=e&&(e=a.option_key(e),e=t.elem(e.opt),0<e.length&&!0!==e.prop("disabled")&&E(e))}},update_visible:function(a,b){A(t.elem(a))},update_disabled:function(a,b){n=b},
update_options:function(){x.empty();q.empty();w()},clear:function(a){q.empty();x.children("li").each(function(){var a=$(this);!0!==a.prop("disabled")&&a.show()})}}}})})(RS2_UI_WEB_VIEW,RS2_CORE_EXPR,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_LOCATION,{create:function(c,d){function b(a,b){a?(b="\u5b9a\u4f4d\u6210\u529f",a.poi&&(b=b+": "+a.poi),e.text(b),f.text("\u91cd\u65b0\u5b9a\u4f4d")):b?(e.text("\u5b9a\u4f4d\u5931\u8d25 "+b.message),f.text("\u91cd\u65b0\u5b9a\u4f4d")):(e.text(""),f.text("\u5f00\u59cb\u5b9a\u4f4d"))}c=a.ctrl_form(c,"rs2_ctrl_location");var e=$("<p>").appendTo(c),f=$("<button>").attr("type","button").appendTo(c).on("click",function(){d.plugin("beginLocation",[],function(a,c){a?(b(c),
d.event_edited(c,!1)):b(void 0,c)})});b(void 0,void 0);return{update_value:function(a,c){b(a)},update_disabled:function(a,b){f.prop("disabled",!0===b)},clear:function(a){b()},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_PHOTO,{create:function(a,d){function b(){g.hide();q.hide();u.show()}function c(a,c,e,f){f&&($("img",g).attr("src",c),g.show(),u.hide(),q.show(),x.unbind("click"),x.click(function(){--y;a.remove();b();d.plugin("removeResource",[1,f,w],function(a,b){});d.event_edited(l.splice(e,1),!1)}))}function f(a,b){var d=y;++y;var e=$("<a>").addClass("rs2_ctrl_photo_img").append($("<img>").attr("src",a));e.insertBefore(n);e.click(function(g){c(e,a,d,b)})}function A(a){d.plugin("getResource",
[1,a],function(b,c){b?f(c.uri,a):f(d.url("photo_missing.png"))})}var w=d.qid;a=$("<div>").appendTo(a);var q=$("<div>").addClass("rs2_ctrl_photo_ctrl").appendTo(a),x=$("<a>").text("\u5220\u9664").appendTo($("<div>").css({float:"right"}).appendTo(q));$("<a>").text("\u8fd4\u56de").on("click",function(){b()}).appendTo(q);var u=$("<div>").addClass("rs2_ctrl_photo_list").appendTo(a),t='<img src="'+d.url("photo_add.png")+'"/>',n=$("<a>").html(t).appendTo(u),g=$("<div>").addClass("rs2_ctrl_photo_zoom").html(t).appendTo(a),
y=0,l=[],m=d.qprop("max"),D=d.qprop("source"),F=!1;n.on("click",function(){F||(m&&y>=m?d.alert("alert","\u672c\u9898\u6700\u591a\u53ea\u80fd\u62cd"+max+"\u5f20\u7167\u7247!"):d.plugin("picture",[w,D],function(a,b){a?(f(b.uri,b.name),l.push(b.name),d.event_edited(l,!1)):e.log("\u62cd\u7167\u5931\u8d25\uff0c"+b.message)}))});return{update_value:function(a,c){b();l=a||[];u.children(".rs2_ctrl_photo_img").remove();if(0<l.length)for(a=0;a<l.length;++a)A(l[a])},update_disabled:function(a,b){F=b},clear:function(a){b();
l=[];y=0;u.children(".rs2_ctrl_photo_img").remove()},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e,c){f.add_ctrl(RS2_T_DROPDOWN,{create:function(c,b){function d(a,b){!1===b?0==a.parent("span.toggleOption").length&&a.wrap('<span class="toggleOption" style="display: none;" />'):a.parent("span.toggleOption").length&&a.unwrap()}function e(){f=b.replace_var(b.qprop("options"),[]);a.select_option(q,"","").prop({disabled:!1,selected:!0});for(var c=0;c<f.length;++c){var e=f[c],n=b.qprop(e,"title");n=a.select_option(q,n?n[0]:"",e);a.set_option_cat(n,b.option_cat(e));0==b.qprop(e,"visible")&&
d(n,!1)}}var f=[];c=a.ctrl_form(c,"rs2_ctrl_select");var w,q=a.tag("<select>",c).on("change",function(){var a=$(this).val();if(""==a)w=void 0,b.event_ui(RS2_M_UI_UNSELECT,a),b.event_edited(void 0,!1,a);else{var c={};b.embeded()&&(c[b.dataid(w)]=void 0);w=a;c[b.dataid(w)]="1";b.event_ui(RS2_M_UI_SELECT,a);b.event_edited(c,!1)}});e();var x={update_value:function(a,c){c||(w=void 0);if(a)for(c=0;c<f.length;++c){var d=f[c];if("1"==a[b.dataid(d)]){w=d;break}}w?q.val(w):x.clear()},update_title:function(a,
b){$("option[value='"+a+"']",q).text(b?b[0]:"")},update_disabled:function(a,b){q.prop("disabled",b)},update_visible:function(a,b){a=$("option[value='"+a+"']",q);d(a,b)},update_option_category:function(b,c){$("option",q).each(function(){var b=$(this);d(b,a.has_option_cat(b,c))})},update_options:function(){q.empty();e()},clear:function(){w=void 0;q.val("")},on_ui_event:function(a){}};return x}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_CORE_EXPR,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_AUTOCOMPLETE,{create:function(c,d){var b=d.replace_var(d.qprop("options"),[]);if(b){var e=[];for(var f=0;f<b.length;++f){var A=b[f],w=A.title,q=typeof w,x="";"string"===q?x=w:"object"===q&&(x=w.zh);e.push({value:A.id,label:x})}}var u,t=d.qprop("search_data"),n=$("<input>").attr("type","text").addClass("rs2_ctrl_text").appendTo(a.ctrl_form(c,"rs2_ctrl_autocomplete")).autocomplete({source:e?e:function(a,b){d.plugin("search",[t,a.term],function(a,c){a?b(c):d.alert("\u63d0\u793a",
"\u65e0\u6cd5\u83b7\u53d6\u641c\u7d22\u7ed3\u679c\uff01")})},focus:function(a,b){return!1},select:function(a,b){a=b.item.label;if((b=b.item.value)&&a){var c={};c[d.dataid("id")]=b;u=c[d.dataid("name")]=a;n.val(u);d.event_edited(c,!1)}return!1}}).val("\u8f93\u5165\u6587\u5b57\uff0c\u4e0b\u62c9\u9009\u62e9").blur(function(){var a=n.val();a&&0<a.length?a!==u&&n.val(u):(u=void 0,n.val("\u8f93\u5165\u6587\u5b57\uff0c\u4e0b\u62c9\u9009\u62e9"),d.event_edited(void 0,!1))}).focus(function(){u||n.val("")});
return{update_value:function(a,b){a=d.update_value(a);n.val(void 0===a?"\u8f93\u5165\u6587\u5b57\uff0c\u4e0b\u62c9\u9009\u62e9":a[d.dataid("name")])},update_disabled:function(a,b){n.prop("disabled",!0===b)},clear:function(a){n.val("")},on_ui_event:function(a){a=a.value;n.val(void 0===a?"\u8f93\u5165\u6587\u5b57\uff0c\u4e0b\u62c9\u9009\u62e9":a[d.dataid("name")])}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){function c(a,b){var c="",d;for(d=0;d<b.length;++d){var e=b[d];c+="<option value="+e+">"+e+"</option>"}a.append(c)}function d(a){$("option[value!=-1]",a).remove();a.val(-1)}function b(b,c,d,e,f){b=a.tag("<tr>",b);$("<label>").attr("for",d).text(e.lang(d,c)).appendTo(a.tag("<td>",b));return $("<select>").attr("id",d).appendTo(a.tag("<td>",b)).append($("<option>").attr("value","-1").text(e.lang("label_select","\u8bf7\u9009\u62e9"))).on("change",f)}f.add_ctrl(RS2_T_PROVCITY,{create:function(e,
f){function z(){if(!F){var a={};u&&(-1==g.val()||x&&-1==E.val())?a=void 0:(w(a,t,"prov"),w(a,n,"city"),w(a,g,"dist"),w(a,m,"town"),w(a,E,"village"));f.event_edited(a,!1)}}function w(a,b,c){void 0!==b&&(b=b.val(),c=q+"."+c,-1==b?delete a[c]:a[c]=b)}var q=f.qid,x=!0===f.qprop("hastown"),u=!0===f.qprop("required");e=a.tag("<table>",a.ctrl_form(e,"rs2_ctrl_provcity"));var t=b(e,"\u7701\u4efd\uff1a","q_provcity_p",f,function(){var a=t.val();d(n);d(g);x&&(d(m),d(E));-1!=a&&c(n,EGOData.c_array(a));z();f.event_ui(RS2_M_UI_INPUT,
void 0,{prov:a})}),n=b(e,"\u57ce\u5e02\uff1a","q_provcity_c",f,function(){var a=t.val(),b=n.val();d(g);x&&(d(m),d(E));-1!=b&&c(g,EGOData.d_array(a,b));z();f.event_ui(RS2_M_UI_INPUT,void 0,{prov:t.val(),city:b})}),g=b(e,"\u533a\u53bf\uff1a","q_provcity_d",f,function(){var a=g.val();x&&(d(m),d(E),-1!=a&&EGOData.t_array(n.val(),a,function(a){a&&(c(m,a),y&&(m.val(y).change(),y=void 0))}));z()}),y,l;if(x){var m=b(e,"\u4e61\u9547\uff1a","q_provcity_t",f,function(){d(E);var a=m.val();-1!=a&&EGOData.v_array(n.val(),
g.val(),a,function(a){a&&c(E,a);l&&(E.val(l),l=void 0)});z()});var E=b(e,"\u6751\uff1a","q_provcity_v",f,function(){E.val();z()})}var F=!1;c(t,EGOData.p_array());return{update_value:function(a,b){F=!0;a?(t.val(a[q+".prov"]).change(),n.val(a[q+".city"]).change(),g.val(a[q+".dist"]),x&&(y=a[q+".town"],l=a[q+".village"],g.change())):-1!=t.val()&&t.val(-1).change();F=!1},update_disabled:function(a,b){t.prop("disabled",!0===b);n.prop("disabled",!0===b);g.prop("disabled",!0===b);x&&(m.prop("disabled",!0===
b),E.prop("disabled",!0===b))},clear:function(a){-1!=t.val()&&t.val(-1).change()},on_ui_event:function(a){a=a.value;a.prov&&t.val(a.prov).change();a.city&&n.val(a.city).change();x&&a.dist&&(g.val(a.dist).change(),m.val(a.town).change())}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_DATETIME,{create:function(c,d){var b=$("<input>").attr("type","date").appendTo(a.ctrl_form(c,"rs2_ctrl_datetime")).change(function(){var a=$(this).val();d.event_edited(a,!1)});return{update_value:function(a,c){b.val(d.update_value(a)||"")},update_disabled:function(a,c){b.prop("disabled",!0===c)},clear:function(a){b.val("")},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_SCALE,{create:function(c,d){function b(a,b){return $("<input>").attr({type:"radio",name:"scale-radio",id:w}).on("change",function(){d.event_ui(RS2_M_UI_INPUT,void 0,b);d.event_edited(b,!1)})}var e=d.qid;c=a.ctrl_form(c,"rs2_ctrl_scale_3");var f=$("<fieldset>").appendTo(c),A=d.qprop("minscale");c=d.qprop("maxscale");for(f.append($("<label>").text(d.qprop("mindesc")));A<=c;++A){var w=e+"_radio_"+A;b(w,A).appendTo(f);$("<label>").attr("for",w).text(""+A).appendTo(f)}f.append($("<label>").text(d.qprop("maxdesc")));
return{update_value:function(a,b){void 0!==a&&$("#"+e+"_radio_"+a,f).prop("checked",!0)},update_disabled:function(a,b){$("input",f).prop("disabled",!0===b)},clear:function(a){$("input",f).prop("checked",!1)},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_RATING,{create:function(c,d){function b(a){for(var b=0;b<q.length;++b)q[b].text(b>a?"\u2606":"\u2605");x=a}function e(a){if(void 0!==a)for(var b=0;b<q.length;++b)if(q[b].attr("rs2-data-value")==a)return b;return-1}var f=a.ctrl_form(c,"rs2_ctrl_rating");c=$("<label>").appendTo(f);var A=d.qprop("minscale"),w=d.qprop("maxscale"),q=[],x=-1,u=!1;if(void 0!=A&&void 0!=w&&A<w)for(;A<=w;++A){var t=$("<a>").attr("rs2-data-value",A).text("\u2606").on("click",function(){if(!u){var a=
$(this).attr("rs2-data-value"),c=e(a);0===c&&x===c&&(c=-1,a=void 0);b(c);d.event_ui(RS2_M_UI_INPUT,void 0,a);d.event_edited(a,!1)}}).appendTo(f);q.push(t)}f=$("<label>").appendTo(f);a.show_inline_texts(c,d.qprop("mindesc"));a.show_inline_texts(f,d.qprop("maxdesc"));return{update_value:function(a,c){b(e(a))},update_disabled:function(a,b){u=b},clear:function(a){b(-1)},on_ui_event:function(a){b(e(a.value))}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_SIGNATURE,{create:function(c,d){function b(a,b){e.attr("src",a||d.url("photo_missing.png"));f.text(b?"\u7b7e\u540d":"\u91cd\u7b7e")}c=a.ctrl_form(c,"rs2_ctrl_signature");var e=$("<img />").appendTo(c),f=$("<button>").attr("type","button").appendTo(c).on("click",function(){d.plugin("signature",[],function(a,c){a&&(b(c.uri,!1),d.event_edited(c.name,!1))})});b();return{update_value:function(a,c){a?d.plugin("getResource",[1,a],function(a,c){b(a?c.uri:void 0,!1)}):b(void 0,
!0)},update_disabled:function(a,b){f.prop("disabled",!0===b)},clear:function(a){b(void 0,!0)},on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_RECORDING,{create:function(c,d){function b(a){x?(t.attr("src",d.url("end_recording.jpg")),n.text("\u7ed3\u675f\u5f55\u97f3")):(t.attr("src",d.url("begin_recording.jpg")),n.text("\u5f00\u59cb\u5f55\u97f3"))}function e(a){var b=u.length;u.push(a);var c=a.file,e=$("<tr>").height(36).appendTo(q);$("<td>").text(c).appendTo(e);$("<td>").text(a.length+"s").appendTo(e);$("<a>").text("\u2716").on("click",function(){d.plugin("ask",["\u786e\u5b9a\u5220\u9664\u8be5\u5f55\u97f3\u6587\u4ef6\uff1f"],
function(a){a&&(d.plugin("removeResource",[2,c,A],function(a,b){}),f(b,e))})}).appendTo($("<td>").width(50).appendTo(e))}function f(a,b){b.remove();u.splice(a,1);d.event_edited(u,!1)}var A=d.qid;c=a.ctrl_form(c,"rs2_ctrl_recording");var w=$("<table>").appendTo(c);c=$("<td>").attr({colspan:"3",align:"center"}).appendTo($("<tr>").appendTo($("<thead>").appendTo(w)));var q=$("<tbody>").appendTo(w),x=!1,u=[];c=$("<a>").on("click",function(){x?(x=!1,d.plugin("endRecording",[A],function(a,c){a?(e({file:c.name,
length:c.length}),d.event_edited(u,!1)):d.plugin("alert",[c.message]);b()})):d.plugin("beginRecording",[A],function(a,c){a?(x=!0,b()):d.plugin("alert",[c.message])})}).appendTo(c);var t=$("<img>").addClass("rs2_ctrl_recording_btn").appendTo(c),n=$("<div>").addClass("rs2_ctrl_recording_text").appendTo(c);b();return{update_value:function(a,b){u=[];q.empty();if(a&&0<a.length)for(b=0;b<a.length;++b)e(a[b])},update_disabled:function(a,b){$("button",w).prop("disabled",!0===b)},clear:function(a){u=[];q.empty()},
on_ui_event:function(a){}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){function c(a,b,c){var d="",e;for(e=0;e<b.length;++e){var f=b[e];if(void 0===c||f.parentId==c)d+="<option value="+f.id+">"+f.title+"</option>"}a.append(d)}function d(a){$("option[value!=-1]",a).remove();a.val(-1)}function b(a){for(var b=a.qid,c=a.qprop("data")||[],d=[],f=0;f<c.length;++f){var x=e.copy_obj(c[f]);x.options=a.replace_var(x.options,[]);d.push(x)}return{levels:function(){return d.length},level:function(a){return d[a]},each_level:function(a){for(var b=0;b<d.length;++b)a(b,
d[b])},value_key:function(a){return b+"."+d[a].id},option:function(a,b){a=d[a].options;for(var c=0;c<a.length;++c){var e=a[c];if(e.id==b)return e}}}}f.add_ctrl(RS2_T_CASCADE,{create:function(e,f){function z(b,e,m){b=a.tag("<div>",b).addClass("rs2_ctrl_cascade_entry");"verticle"==g?b.addClass("rs2_layout_verticle"):b.addClass("rs2_layout_horizontal");var l="__"+q+"_cascade_"+m;$("<label>").attr("for",l).text(e.title+"\uff1a").appendTo(a.tag("<div>",b));return $("<select>").attr("id",l).appendTo(a.tag("<div>",
b).addClass("rs2_input_wrap")).append($("<option>").attr("value","-1").text("\u8bf7\u9009\u62e9")).on("change",function(){var a=$(this).val();if(m==u-1){a={};for(var b=0;b<u;++b)a[x.value_key(b)]=n[b].val();f.event_edited(a,!1)}else{for(b=m+1;b<u;++b)d(n[b]);-1!=a&&c(n[m+1],x.level(m+1).options,a);b={};b[x.value_key(m)]=a;f.event_ui(RS2_M_UI_INPUT,void 0,b)}})}function w(){if(0<n.length){var a=n[0];-1!=a.val()&&a.val(-1).change()}}var q=f.qid,x=b(f),u=x.levels(),t=a.tag("<div>",a.ctrl_form(e,"rs2_ctrl_cascade")),
n=[],g=f.qprop("layout");x.each_level(function(a,b){var d=z(t,b,a);n.push(d);0==a&&c(d,b.options)});return{update_value:function(a,b){a?x.each_level(function(b,c){c=a[x.value_key(b)];var d=n[b];d.val(c);b<u-1&&d.change()}):w()},update_disabled:function(a,b){for(a=0;a<u;++a)n[a].prop("disabled",!0===b)},clear:function(a){w()},on_ui_event:function(a){var b=a.value;if(b){var e=u;x.each_level(function(a,f){if((f=b[x.value_key(a)])||a>e)if(d(n[a]),f){var g=x.option(a,f);g&&(c(n[a],[g]),n[a].val(f));e=
a}})}}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_UPLOAD,{create:function(c,d){a.div(c,"rs2_ctrl_wrap").text("\u624b\u673a\u7aef\u8d5e\u4e0d\u652f\u6301\uff0c\u8bf7\u5230\u7f51\u9875\u7aef\u4f5c\u7b54\uff01");return{update_value:function(a,c){},update_content:function(b,c){a.show_texts(_text,b)}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);(function(f,a,e){f.add_ctrl(RS2_T_UNKNOWN,{create:function(c,d){var b=$("<textarea>").css({width:"90%",height:"50px"}).appendTo(a.ctrl_form(c)).blur(function(){var a=$(this).val();a&&(a=JSON.parse(a));d.event_edited(a,!0)});a.filter_illegal_char(b);return{update_value:function(a,c){(a=d.update_value(a))&&(a=JSON.stringify(a));b.val(a||"")},update_disabled:function(a,c){b.attr("disabled",!0===c)},clear:function(a){b.val("")}}}})})(RS2_UI_WEB_VIEW,RS2_UI_HTML,RS2_UTIL);var RS2_UI_CACHE=function(){return{create:function(f){function a(a){for(var b=0;b<d.length;++b)if(d[b].pid===a)return b}function e(a){for(a+=1;a<d.length;++a){var b=d[a];if(void 0!==b.page){delete b.page;break}}}var c=0<f?f:200,d=[];return{push:function(a,f){d.length>=c&&e(0);d.push({pid:a,page:f})},page:function(b){b=a(b);if(0<=b)return d[b].page},put:function(b,f){b=a(b);if(0<=b){var z=d[b];void 0===z.page&&d.length>=c&&e(b);z.page=f}},reset:function(b){b=a(b);0<=b&&d.splice(b+1,d.length-b-1)}}}}}();var RS2_UI_WEB_MENU=function(f){function a(a,d,b){var c=$("<div>").appendTo(a),e=d.page.title;e||(e=d.questions[0].title);f.texts(c,e,d.qid+".").addClass("rs2_menu_page");c.on("click",function(a){a.stopPropagation();b.menu_event(d.qid)});return{qid:d.qid,remove:function(){a.remove()},select:function(b){b?a.addClass("rs2_menu_selected"):a.removeClass("rs2_menu_selected")}}}function e(c,d,b){var z=$("<div>").addClass("rs2_menu").appendTo(c);if(d){var E=d.id;var A=$("<div>").addClass("rs2_menu_section").appendTo(z),
w=$("<div>").text("-").addClass("rs2_menu_icon").css({"margin-right":8,float:"right","z-index":2}).appendTo(A);f.texts(A,d.title);A.on("click",function(a){a.stopPropagation();q.toggle();w.text(q.is(":visible")?"-":"+")})}var q=$("<ul>").appendTo(z),x=[];return{sid:E,add_page:function(c){c=a($("<li>").appendTo(q),c,b);x.push(c);return c},add_section:function(a){a=e($("<li>").appendTo(q),a,b);x.push(a);return a},remove:function(){c.remove()},reset:function(a,b){for(var c,d=0;d<x.length;++d){var e=x[d].qid;
if(e){if(e===a){c=d;break}}else if(x[d].reset(a,b)){c=d;break}}if(0<=c){a=x.splice(c+1,x.length-c-1);for(d=0;d<a.length;++d)c=a[d],void 0!==c.sid&&b&&delete b[c.sid],c.remove();return!0}return!1},select:function(a){for(var b=0;b<x.length;++b){var c=x[b],d=c.qid;if(d){if(d===a)return c.select(!0),c}else if(c=c.select(a))return c}}}}return{create:function(a,d){function b(a){var d=a.length-1,e=a[d];sobj=c[e.id];if(!sobj){var f=A;0<d&&(f=b(a.slice(0,d)));sobj=f.add_section(e);c[e.id]=sobj}return sobj}
var c={},f=$("<ul>").addClass("rs2_menu_props").appendTo(a),A=e(a,void 0,d),w;return{new_page:function(a,c){var d=A,e=a.page.sections;e&&(d=b(e));a=d.add_page(a);c&&(w&&w.select(!1),a.select(!0),w=a)},restore:function(a){if(a)for(var b=a.length,c=0;c<b;++c)this.new_page(a[c],c==b-1)},select:function(a){a=A.select(a);void 0!==w&&w!==a&&w.select(!1);w=a},reset:function(a){A.reset(a,c)},show_props:function(a){if(a){var b;for(b=0;b<a.length;++b){var c=a[b];$("<li>").append($("<span>").addClass("rs2_menu_props_name").text(c.name+
":")).append($("<span>").addClass("rs2_menu_props_value").text(c.value)).appendTo(f)}}}}}}}(RS2_UI_HTML);var RS2_SURVEY_MONITOR=function(f,a){function e(){var c={};c.scroll_bar_width=a.scrollbarWidth();return c}return{create:function(){function a(a,b){a&&(a=d.create_page(a),d.show_page(a));b&&d.show_nav(b)}var d,b=e(),z,E={init:function(a,c){if(c)for(var e in c)b[e]=c[e];this.device=b;d=f.create(a,E)},monitor_event:function(b){switch(b.type){case RS2_M_INIT:d.init(b.survey_props,{edit_type:RS2_I_EDIT_VIEW});a(b.page,b.nav);break;case RS2_M_PAGE:a(b.page,b.nav);d.update_survey(b.survey);break;case RS2_M_UPDATE:var c=
b.question;if(c)for(var e=0;e<c.length;++e)d.update_question(c[e]);d.update_survey(b.survey);break;case RS2_M_EDITED:d.update_question(b);break;case RS2_M_ALERT:alert(b.messages.join("."));break;case RS2_M_UI:d.on_ui_event(b)}},event:function(){},event_ui:function(){},set_plugin:function(a){z=a},plugin:function(a,b,c){z&&z.call(a,b||[],c)},url:function(a){return z&&z.url?z.url(a):a}};return E}}}(RS2_UI_WEB_VIEW,RS2_UI_HTML);var RS2_SURVEY_FRONT=function(f,a,e,c,d,b){function z(){var a={};a.scroll_bar_width=d.scrollbarWidth();return a}return{create:function(){function d(a){t&&b.call_async(function(){t.send(a)})}function A(a,b,c){n&&n.call(a,b||[],c)}var w=f.create();window.$survey=w;var q,x=c.create(),u,t,n,g,y,l=!1,m,D=!1,F={init:function(b,c,d){u=z();if(c)for(var f in c)u[f]=c[f];this.device=u;q=a.create(b,F);(y=d)?g=e.create(y,F):(l=!0,y=$("<div>").css({position:"absolute","z-index":2,width:u.width,height:u.height}).addClass("rs2_menu_wrap").offset(b.position()).appendTo(b).hide(),
y.on("click",function(a){y.hide()}),b=$("<div>").addClass("rs2_menu_bg").appendTo(y),g=e.create(b,F))},lang_res:function(b){a.lang_res(b)},load_remote:function(a,c){b.info("load survey at "+a);$.getScript(a,function(a,d,e){b.info("survey  loaded "+d+" , "+e.status);c&&F.load_rules(c)})},load_rules:function(a){if(a&&0<a.length){var c=a[0],d=1<a.length?a.slice(1):void 0;b.info("load rules at "+c);$.getScript(c,function(a,c,e){b.info("rule script loaded "+c+" , "+e.status);d&&F.load_rules(d)})}},set_plugin:function(a){n=
a},plugin:A,url:function(a){return n&&n.url?n.url(a):a},start:function(a){D=!1;a||(a={interview:{}});var b=w.survey_props(),c=a.interview;q.init(b,c);c&&g.show_props(c.menu_props);d({type:RS2_M_INIT,survey_props:b});this.event({name:"start",param:{state:a.state,data:a.data,variables:a.variables,interview:c,externs:a.externs}})},start_monitor:function(a){t=a;q&&d({type:RS2_M_INIT,survey_props:w.survey_props(),page:$survey.page(),nav:m})},end_monitor:function(){t=void 0},event_ui:function(a){d(a)},
event_edited:function(a,b,c,e){this.event({name:"edited",param:{qid:a,value:b,update:c}});!1!==e&&d({type:RS2_M_EDITED,qid:a,prop:"value",value:b,update:c})},menu_event:function(a){F.event({name:"prev",param:{qid:a}})},event:function(a){l&&F.hide_menu();this.handle_update($survey.event(a),a.name)},handle_update:function(a,b){switch(a.page){case RS2_P_NOACTION:var c=a.question;if(c)for(var e=0;e<c.length;++e)q.update_question(c[e]);"edited"===b&&(D=!1,q.reset_editing(a.target));d({type:RS2_M_UPDATE,
question:c,survey:a.survey});break;case RS2_P_EDITED:b=a.target;m=a.nav;q.show_nav(m);b&&(e=x.page(b));e||(c=$survey.page(),e=q.create_page(c),x.put(b,e));q.show_page(e,!1);g.select(b);A("prevPageLoaded",[m]);t&&(c||(c=$survey.page()),d({type:RS2_M_PAGE,page:c,nav:m,survey:a.survey}));break;case RS2_P_NEW:D=!1;q.clear_messages();if(c=a.alerts)A("alert",[c]),d({type:RS2_M_ALERT,messages:c});m=a.nav;q.show_nav(m);c=$survey.page();e=q.create_page(c);x.push(e.pid,e);q.show_page(e,!0);d({type:RS2_M_PAGE,
page:c,nav:m,survey:a.survey});"start"===b?(A("onstart",[q.state()]),g.restore($survey.page_history())):g.new_page(c,!0);A("nextPageLoaded",[m]);break;case RS2_P_INVALID:(b=a.messages)&&q.show_messages(b);break;case RS2_P_ALERT:d({type:RS2_M_ALERT,messages:a.alerts});A("alert",[a.alerts]);break;case RS2_P_EXIT:A("exit"),D&&A("submit"),D=!0,a.alerts&&(d({type:RS2_M_ALERT,messages:a.alerts}),A("alert",[a.alerts]))}a.page_updated&&(b=a.target,x.reset(b),g.reset(b),A("pageEdited"));q.update_survey(a.survey)},
submit_data:function(){return{state:w.state(),data:w.data()}},show_menu:function(){l&&y.show()},hide_menu:function(){l&&y.hide()},toggle_menu:function(){l&&(y.is(":visible")?y.hide():y.show())},toggle_remark:function(){q.toggle_remark()},alert:function(a){A("alert",[a])}};return F}}}(RS2_CORE_SURVEY_CTRL,RS2_UI_WEB_VIEW,RS2_UI_WEB_MENU,RS2_UI_CACHE,RS2_UI_HTML,RS2_UTIL);
